{"remainingRequest":"/home/jr/devspace/simpleCRM/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/jr/devspace/simpleCRM/src/components/agenda.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/jr/devspace/simpleCRM/src/components/agenda.vue","mtime":1643810203940},{"path":"/home/jr/devspace/simpleCRM/node_modules/@vue/cli-plugin-babel/node_modules/cache-loader/dist/cjs.js","mtime":1643224169106},{"path":"/home/jr/devspace/simpleCRM/node_modules/@vue/cli-plugin-babel/node_modules/babel-loader/lib/index.js","mtime":1643224169006},{"path":"/home/jr/devspace/simpleCRM/node_modules/@vue/cli-service/node_modules/cache-loader/dist/cjs.js","mtime":1643224169106},{"path":"/home/jr/devspace/simpleCRM/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1643224172087}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IENhbGVuZGFyIH0gZnJvbSAiQHRvYXN0LXVpL3Z1ZS1jYWxlbmRhciI7IC8qIEVTNiAqLwppbXBvcnQgInR1aS1jYWxlbmRhci9kaXN0L3R1aS1jYWxlbmRhci5jc3MiOwovLyBJZiB5b3UgdXNlIHRoZSBkZWZhdWx0IHBvcHVwcywgdXNlIHRoaXMuCmltcG9ydCAidHVpLWRhdGUtcGlja2VyL2Rpc3QvdHVpLWRhdGUtcGlja2VyLmNzcyI7CmltcG9ydCAidHVpLXRpbWUtcGlja2VyL2Rpc3QvdHVpLXRpbWUtcGlja2VyLmNzcyI7CgppbXBvcnQgYXhpb3MgZnJvbSAiYXhpb3MiOwoKaW1wb3J0IG1vbWVudCBmcm9tICJtb21lbnQiOwoKaW1wb3J0IG15VGhlbWUgZnJvbSAiLi9teVRoZW1lIjsKaW1wb3J0IE11bHRpc2VsZWN0IGZyb20gInZ1ZS1tdWx0aXNlbGVjdCI7CmltcG9ydCAidnVlLW11bHRpc2VsZWN0L2Rpc3QvdnVlLW11bHRpc2VsZWN0Lm1pbi5jc3MiOwovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKY29uc3QgZ2V0RGF0ZSA9ICh0eXBlLCBzdGFydCwgdmFsdWUsIG9wZXJhdG9yKSA9PiB7CiAgc3RhcnQgPSBuZXcgRGF0ZShzdGFydCk7CiAgdHlwZSA9IHR5cGUuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyB0eXBlLnNsaWNlKDEpOwogIGlmIChvcGVyYXRvciA9PT0gIisiKSB7CiAgICBzdGFydFtgc2V0JHt0eXBlfWBdKHN0YXJ0W2BnZXQke3R5cGV9YF0oKSArIHZhbHVlKTsKICB9IGVsc2UgewogICAgc3RhcnRbYHNldCR7dHlwZX1gXShzdGFydFtgZ2V0JHt0eXBlfWBdKCkgLSB2YWx1ZSk7CiAgfQogIHJldHVybiBzdGFydDsKfTsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsgQ2FsZW5kYXIsIE11bHRpc2VsZWN0IH0sCiAgcHJvcHM6IHsKICAgIEFQSV9LRVk6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiAiIjsKICAgICAgfSwKICAgIH0sCgogICAgVVJJOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gImh0dHBzOi8vMDAwMi16ZWJyaWRnZS1kZXYtZXh0ZXJuZS5hcGkuY3JtLXNpbXBsZS5jb20vaW50ZXJhY3Rpb25zLyI7CiAgICAgIH0sCiAgICB9LAoKICAgIFVSSV9ISVNUT1JZOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gImh0dHBzOi8vMDAwMi16ZWJyaWRnZS1kZXYtZXh0ZXJuZS5hcGkuY3JtLXNpbXBsZS5jb20vaW50ZXJhY3Rpb25zaGlzdG9yaXF1ZS8iOwogICAgICB9LAogICAgfSwKCiAgICBVUklfQUNUSU9OOiB7CiAgICAgIHR5cGU6IFN0cmluZywKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gImh0dHBzOi8vMDAwMi16ZWJyaWRnZS1kZXYtZXh0ZXJuZS5hcGkuY3JtLXNpbXBsZS5jb20vaW50ZXJhY3Rpb24vIjsKICAgICAgfSwKICAgIH0sCgogICAgVVJJX0FDVElPTl9DUkVBVElPTjogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuICJodHRwczovLzAwMDItemVicmlkZ2UtZGV2LWV4dGVybmUuY3JtLXNpbXBsZS5jb20vYWN0aW9uX2VkaXQucGhwIjsKICAgICAgfSwKICAgIH0sCgogICAgVVJJX0FDVElPTl9VUERBVEU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiAiaHR0cHM6Ly8wMDAyLXplYnJpZGdlLWRldi1leHRlcm5lLmNybS1zaW1wbGUuY29tL2FjdGlvbl9lZGl0LnBocD9pZGFjdGlvbj0iOwogICAgICB9LAogICAgfSwKCiAgICBsb2NhbGU6IHsKICAgICAgdHlwZTogU3RyaW5nLAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiAiZnItRlIiOwogICAgICB9LAogICAgfSwKCiAgICBjYWxlbmRhckxpc3Q6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFsKICAgICAgICAgIHsKICAgICAgICAgICAgaWQ6ICIwIiwKICAgICAgICAgICAgbmFtZTogIlByaXZhdGUiLAogICAgICAgICAgICBiZ0NvbG9yOiAiIzllNWZmZiIsCiAgICAgICAgICAgIGJvcmRlckNvbG9yOiAiIzllNWZmZiIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBpZDogIjEiLAogICAgICAgICAgICBuYW1lOiAiQ29tcGFueSIsCiAgICAgICAgICAgIGJnQ29sb3I6ICIjMDBhOWZmIiwKICAgICAgICAgICAgYm9yZGVyQ29sb3I6ICIjMDBhOWZmIiwKICAgICAgICAgIH0sCiAgICAgICAgXTsKICAgICAgfSwKICAgIH0sCiAgICBVU0VSX0FQSTogewogICAgICB0eXBlOiBTdHJpbmcsCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuICJodHRwczovLzAwMDItemVicmlkZ2UtZGV2LWV4dGVybmUuYXBpLmNybS1zaW1wbGUuY29tL3V0aWxpc2F0ZXVycy8iOwogICAgICB9LAogICAgfSwKICAgIGFycmF5RmlsdGVyOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbG9yOiAiIzIyNTFmZiIsCiAgICAgICAgICAgIHRpdGxlOiAiRMOpZmF1dCIsCiAgICAgICAgICAgIGluZGV4OiAiY29sb3JfZGVmYXV0IiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbG9yOiAiI2ZmY2VkZjAiLAogICAgICAgICAgICB0aXRsZTogIkV0YXQiLAogICAgICAgICAgICBpbmRleDogImNvbG9yX2V0YXQiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgY29sb3I6ICIjMjVmZmNkIiwKICAgICAgICAgICAgdGl0bGU6ICJQcmlvcml0w6kiLAogICAgICAgICAgICBpbmRleDogImNvbG9yX3ByaW9yaXRlIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbG9yOiAiI2RlNDUyYSIsCiAgICAgICAgICAgIHRpdGxlOiAiVXRpbGlzYXRldXIiLAogICAgICAgICAgICBpbmRleDogImNvbG9yX3V0aWxpc2F0ZXVyIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIGNvbG9yOiAiI2NkZWUwMCIsCiAgICAgICAgICAgIHRpdGxlOiAiVHlwZSIsCiAgICAgICAgICAgIGluZGV4OiAiY29sb3JfdHlwZSIsCiAgICAgICAgICB9LAogICAgICAgICAgewogICAgICAgICAgICBjb2xvcjogIiNlMTk0MDAiLAogICAgICAgICAgICB0aXRsZTogIlByaW9yaXTDqSDDqWNow6lhbmNlIiwKICAgICAgICAgICAgaW5kZXg6ICJjb2xvcl9wcmlvcml0ZV9lY2hlYW5jZSIsCiAgICAgICAgICB9LAogICAgICAgIF07CiAgICAgIH0sCiAgICB9LAogICAgaWRVdGlsaXNhdGV1cnM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFsiMSIsICIyIiwgIjMiLCAiNCIsICI1IiwgIjYiLCAiNyIsICI4IiwgIjkiXTsKICAgICAgfSwKICAgIH0sCiAgICBpZHByb2pldHM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9LAogICAgfSwKICAgIGlkY29udGFjdHM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9LAogICAgfSwKICAgIGlkc29jaWV0ZXM6IHsKICAgICAgdHlwZTogQXJyYXksCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIFtdOwogICAgICB9LAogICAgfSwKICAgIHNjaGVkdWxlTGlzdDogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gW107CiAgICAgIH0sCiAgICB9LAogICAgdmlld01vZGVPcHRpb25zOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHRpdGxlOiAiTW9pcyIsCiAgICAgICAgICAgIHZhbHVlOiAibW9udGgiLAogICAgICAgICAgfSwKICAgICAgICAgIHsKICAgICAgICAgICAgdGl0bGU6ICJTZW1haW5lIiwKICAgICAgICAgICAgdmFsdWU6ICJ3ZWVrIiwKICAgICAgICAgIH0sCiAgICAgICAgICB7CiAgICAgICAgICAgIHRpdGxlOiAiSm91ciIsCiAgICAgICAgICAgIHZhbHVlOiAiZGF5IiwKICAgICAgICAgIH0sCiAgICAgICAgXTsKICAgICAgfSwKICAgIH0sCgogICAgZGF0ZVJhbmdlOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiBbbW9tZW50KCkuc3VidHJhY3QoMSwgIm1vbnRoIikudG9EYXRlKCksIG1vbWVudCgpLnRvRGF0ZSgpXTsKICAgICAgfSwKICAgIH0sCgogICAgdGltZXpvbmVzOiB7CiAgICAgIHR5cGU6IEFycmF5LAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiBbCiAgICAgICAgICAvLyBwYXJpcwogICAgICAgICAgewogICAgICAgICAgICBuYW1lOiAiRXVyb3BlL1BhcmlzIiwKICAgICAgICAgICAgbGFiZWw6ICJQYXJpcyIsCiAgICAgICAgICAgIG9mZnNldDogIiswMTowMCIsCiAgICAgICAgICB9LAogICAgICAgIF07CiAgICAgIH0sCiAgICB9LAoKICAgIG1vbnRoOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgc3RhcnREYXlPZldlZWs6IDEsCiAgICAgICAgICBkYXluYW1lczogWyJEaW0iLCAiTHVuIiwgIk1hciIsICJNZXIiLCAiSmV1IiwgIlZlbiIsICJTYW0iXSwKICAgICAgICB9OwogICAgICB9LAogICAgfSwKCiAgICB3ZWVrOiB7CiAgICAgIHR5cGU6IE9iamVjdCwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgc2hvd1RpbWV6b25lQ29sbGFwc2VCdXR0b246IHRydWUsCiAgICAgICAgICB0aW1lem9uZXNDb2xsYXBzZWQ6IHRydWUsCiAgICAgICAgICBkYXluYW1lczogWyJEaW0iLCAiTHVuIiwgIk1hciIsICJNZXIiLCAiSmV1IiwgIlZlbiIsICJTYW0iXSwKICAgICAgICAgIHN0YXJ0RGF5T2ZXZWVrOiAxLAogICAgICAgIH07CiAgICAgIH0sCiAgICB9LAoKICAgIHRhc2tWaWV3OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0sCiAgICB9LAoKICAgIHNjaGVkdWxlVmlldzogewogICAgICB0eXBlOiBBcnJheSwKICAgICAgZGVmYXVsdCgpIHsKICAgICAgICByZXR1cm4gWyJ0aW1lIl07CiAgICAgIH0sCiAgICB9LAoKICAgIGRpc2FibGVEYmxDbGljazogewogICAgICB0eXBlOiBCb29sZWFuLAogICAgICBkZWZhdWx0KCkgewogICAgICAgIHJldHVybiB0cnVlOwogICAgICB9LAogICAgfSwKCiAgICBpc1JlYWRPbmx5OiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9LAogICAgfSwKCiAgICAvLyB2aWV3OiB7CiAgICAvLyAgIHR5cGU6IFN0cmluZywKICAgIC8vICAgZGVmYXVsdCgpIHsKICAgIC8vICAgICByZXR1cm4gIm1vbnRoIjsKICAgIC8vICAgfSwKICAgIC8vIH0sCiAgICB1c2VDcmVhdGlvblBvcHVwOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9LAogICAgfSwKICAgIHVzZURldGFpbFBvcHVwOiB7CiAgICAgIHR5cGU6IEJvb2xlYW4sCiAgICAgIGRlZmF1bHQoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9LAogICAgfSwKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VyczogW10sCiAgICAgIHNlbGVjdGVkVXNlcnM6IFtdLAogICAgICBlZGl0aW5nOiBmYWxzZSwKICAgICAgaGlzdG9yeTogZmFsc2UsCiAgICAgIGNyZWF0aW5nOiBmYWxzZSwKICAgICAgY2xpY2tDb3VudDogMCwKICAgICAgc2VsZWN0ZWQ6IG51bGwsCiAgICAgIGlzRnVsbFBhZ2U6IGZhbHNlLAogICAgICBpc0xvYWRpbmc6IHRydWUsCiAgICAgIGluZm86IG51bGwsCiAgICAgIGV2ZW50OiBudWxsLAogICAgICB2aWV3OiAibW9udGgiLAogICAgICBpc0NvbXBvbmVudE1vZGFsQWN0aXZlOiBmYWxzZSwKICAgICAgcmVuZGVyUmFuZ2U6IG51bGwsCiAgICAgIHN0YXJ0RGF0ZTogIiIsCiAgICAgIGVuZERhdGU6ICIiLAogICAgICBkYXRlQ3JlYXRlRXZlbnQ6ICIiLAogICAgICBmb3JtOiB7CiAgICAgICAgc3VqZXQ6ICIiLAogICAgICAgIGNvbG9yOiAiIiwKICAgICAgICBkYXRlX2RlYnV0OiAiIiwKICAgICAgICBkYXRlX2ZpbjogIiIsCgogICAgICAgIHN1Ym1pdDogZmFsc2UsCiAgICAgIH0sCiAgICAgIGVycm9yczogewogICAgICAgIHN1amV0OiAiTGUgY2hhbXBzIHRpdHJlIGVzdCBvYmxpZ2F0b2lyZSIsCiAgICAgICAgZGF0ZV9kZWJ1dDogIkxlIGRhdGUgZGVidXQgZXN0IG9ibGlnYXRvaXJlIiwKICAgICAgICBkYXRlX2ZpbjogIkxlIGRhdGUgZmluIGVzdCBvYmxpZ2F0b2lyZSIsCiAgICAgICAgY29sb3I6ICJMZSBjaGFtcHMgY291bGV1ciBlc3Qgb2JsaWdhdG9pcmUiLAogICAgICB9LAogICAgICB0ZW1wbGF0ZTogdGhpcy5nZXRUZW1wbGF0ZSgpLAogICAgICB0aGVtZTogbXlUaGVtZSwKICAgICAgQ3NjaGVkdWxlTGlzdDogW10sCiAgICAgIHNob3dpbmc6ICIiLAogICAgICB0eXBldmlldzogewogICAgICAgIHRpdGxlOiAiU2VsZWN0aW9ubmV6IiwKICAgICAgICBjb2xvcjogIiMyMjUxZmYiLAogICAgICAgIGluZGV4OiAiY29sb3JfZGVmYXV0IiwKICAgICAgfSwKICAgIH07CiAgfSwKCiAgbWV0aG9kczogewogICAgc2hvdygpIHsKICAgICAgdGhpcy5zaG93aW5nID0gdGhpcy5zaG93aW5nLmxlbmd0aCA9PT0gMCA/ICJpcy1hY3RpdmUiIDogIiI7CiAgICB9LAoKICAgIHNldFZpZXcodHlwZSkgewogICAgICB0aGlzLnR5cGV2aWV3ID0gdHlwZTsKICAgICAgdGhpcy5zaG93KCk7IC8vIHNob3cgb3IgaGlkZSB0aGUgZHJvcGRvd24KCiAgICAgIHRoaXMuZGlzcGF0Y2hBY3Rpb24oKTsKICAgIH0sCiAgICBpc1VzZXJTZWxlY3RlZChpZFVzZXIpIHsKICAgICAgcmV0dXJuIHRoaXMuaWRVdGlsaXNhdGV1cnMuZmluZChpZFVzZXIpID4gMDsKICAgIH0sCiAgICBhc3luYyBsb2FkVXNlcnMoKSB7CiAgICAgIGF3YWl0IGF4aW9zKHsKICAgICAgICBtZXRob2Q6ICJnZXQiLAogICAgICAgIHVybDogdGhpcy5VU0VSX0FQSSArIHRoaXMuQVBJX0tFWSwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgIH0sCiAgICAgIH0pCiAgICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5yZXN1bHQgPT09IDEpIHsKICAgICAgICAgICAgdGhpcy51c2VycyA9IHJlc3BvbnNlLmRhdGEuZGF0YS5tYXAoKGVsKSA9PiB7CiAgICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICAgIGlkOiBlbC5pZHV0aWxpc2F0ZXVyLnZhbHVlLnRvU3RyaW5nKCksCiAgICAgICAgICAgICAgICBuYW1lOiBlbC5ub21fdXRpbGlzYXRldXIudmFsdWUudG9TdHJpbmcoKSwKICAgICAgICAgICAgICB9OwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgdGhpcy5zZWxlY3RlZFVzZXJzID0gdGhpcy51c2Vycy5maWx0ZXIoCiAgICAgICAgICAgICAgKHgpID0+IHguaWQgaW4gdGhpcy5pZFV0aWxpc2F0ZXVycwogICAgICAgICAgICApOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2UuZGF0YS5lcnJfbWVzc2FnZSk7CiAgICAgICAgICB9CiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goKGVycikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBkaXNwYXRjaEFjdGlvbigpIHsKICAgICAgdGhpcy5pc0xvYWRpbmcgPSB0cnVlOwoKICAgICAgLy8gY2FsbGluZiBmaXNydCByb3V0ZQogICAgICB0aGlzLkNzY2hlZHVsZUxpc3QgPSBhd2FpdCB0aGlzLmdldENhbGVuZGFySXRlbSgwLCBmYWxzZSkudGhlbigKICAgICAgICAoaXRlbXMpID0+IHsKICAgICAgICAgIHJldHVybiBpdGVtcy5mbGF0KEluZmluaXR5KTsKICAgICAgICB9CiAgICAgICk7CgogICAgICAvLyAyIHJvdXRlIG9uRHVlRGF0ZSBpcyB0cnVlCiAgICAgIHRoaXMuQ3NjaGVkdWxlTGlzdCA9IHRoaXMuQ3NjaGVkdWxlTGlzdC5jb25jYXQoCiAgICAgICAgYXdhaXQgdGhpcy5nZXRDYWxlbmRhckl0ZW0oMCwgdHJ1ZSkudGhlbigoaXRlbXMpID0+IHsKICAgICAgICAgIHJldHVybiBpdGVtcy5mbGF0KEluZmluaXR5KTsKICAgICAgICB9KQogICAgICApOwoKICAgICAgLy8gY2FsbGluZyB0aGlyZCByb3V0ZQogICAgICBpZiAodGhpcy5oaXN0b3J5KSB7CiAgICAgICAgdGhpcy5Dc2NoZWR1bGVMaXN0ID0gdGhpcy5Dc2NoZWR1bGVMaXN0LmNvbmNhdCgKICAgICAgICAgIGF3YWl0IHRoaXMuZ2V0SXRlcmFjdGlvbnNIaXN0b3J5KDApLnRoZW4oKGhpc3RvcnlJdGVtcykgPT4gewogICAgICAgICAgICByZXR1cm4gaGlzdG9yeUl0ZW1zLmZsYXQoSW5maW5pdHkpOwogICAgICAgICAgfSkKICAgICAgICApOwogICAgICB9CiAgICAgIHRoaXMuaXNMb2FkaW5nID0gZmFsc2U7CiAgICB9LAoKICAgIHNldENvbG9yKHR5cGUsIGRhdGEpIHsKICAgICAgbGV0IGNvbG9yID0gdHlwZS5jb2xvcjsKICAgICAgdHJ5IHsKICAgICAgICBjb25zdCBqc29uZGF0YSA9IGRhdGEuY29sb3IudmFsdWU7CiAgICAgICAgY29sb3IgPSBKU09OLnBhcnNlKGpzb25kYXRhKVt0eXBlLmluZGV4XTsKICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICBjb25zb2xlLmxvZygidW5kZWZpbmVkIGNvbG9yIGRhdGEiKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGNvbG9yOwogICAgfSwKICAgIGdldFRlbXBsYXRlKCkgewogICAgICBjb25zdCB0aCA9IHRoaXM7CiAgICAgIHJldHVybiB7CiAgICAgICAgbWlsZXN0b25lOiBmdW5jdGlvbiAoc2NoZWR1bGUpIHsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICc8c3BhbiBjbGFzcz0iY2FsZW5kYXItZm9udC1pY29uIGljLW1pbGVzdG9uZS1iIj48L3NwYW4+IDxzcGFuIHN0eWxlPSJiYWNrZ3JvdW5kLWNvbG9yOiAnICsKICAgICAgICAgICAgc2NoZWR1bGUuYmdDb2xvciArCiAgICAgICAgICAgICciPicgKwogICAgICAgICAgICBzY2hlZHVsZS50aXRsZSArCiAgICAgICAgICAgICI8L3NwYW4+IgogICAgICAgICAgKTsKICAgICAgICB9LAogICAgICAgIG1pbGVzdG9uZVRpdGxlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJ0dWktZnVsbC1jYWxlbmRhci1sZWZ0LWNvbnRlbnQiPkVUQVBFPC9zcGFuPic7CiAgICAgICAgfSwKICAgICAgICB0YXNrOiBmdW5jdGlvbiAoc2NoZWR1bGUpIHsKICAgICAgICAgIHJldHVybiAiIyIgKyBzY2hlZHVsZS50aXRsZTsKICAgICAgICB9LAogICAgICAgIHRhc2tUaXRsZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICc8c3BhbiBjbGFzcz0idHVpLWZ1bGwtY2FsZW5kYXItbGVmdC1jb250ZW50Ij5UQUNIRTwvc3Bhbj4nOwogICAgICAgIH0sCiAgICAgICAgYWxsZGF5OiBmdW5jdGlvbiAoc2NoZWR1bGUpIHsKICAgICAgICAgIHJldHVybiB0aC5fZ2V0VGltZVRlbXBsYXRlKHNjaGVkdWxlLCB0cnVlKTsKICAgICAgICB9LAogICAgICAgIGFsbGRheVRpdGxlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gJzxzcGFuIGNsYXNzPSJ0dWktZnVsbC1jYWxlbmRhci1sZWZ0LWNvbnRlbnQiPiBUb3V0ZSBsYSBqb3VybsOpZTwvc3Bhbj4nOwogICAgICAgIH0sCiAgICAgICAgdGltZTogZnVuY3Rpb24gKHNjaGVkdWxlKSB7CiAgICAgICAgICByZXR1cm4gdGguX2dldFRpbWVUZW1wbGF0ZShzY2hlZHVsZSwgZmFsc2UpOwogICAgICAgIH0sCiAgICAgICAgZ29pbmdEdXJhdGlvbjogZnVuY3Rpb24gKHNjaGVkdWxlKSB7CiAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICAnPHNwYW4gY2xhc3M9ImNhbGVuZGFyLWljb24gaWMtdHJhdmVsLXRpbWUiPjwvc3Bhbj4nICsKICAgICAgICAgICAgc2NoZWR1bGUuZ29pbmdEdXJhdGlvbiArCiAgICAgICAgICAgICJtaW4uIgogICAgICAgICAgKTsKICAgICAgICB9LAogICAgICAgIGNvbWluZ0R1cmF0aW9uOiBmdW5jdGlvbiAoc2NoZWR1bGUpIHsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICc8c3BhbiBjbGFzcz0iY2FsZW5kYXItaWNvbiBpYy10cmF2ZWwtdGltZSI+PC9zcGFuPicgKwogICAgICAgICAgICBzY2hlZHVsZS5jb21pbmdEdXJhdGlvbiArCiAgICAgICAgICAgICJtaW4uIgogICAgICAgICAgKTsKICAgICAgICB9LAogICAgICAgIG1vbnRoTW9yZVRpdGxlRGF0ZTogZnVuY3Rpb24gKGRhdGUsIGRheW5hbWUpIHsKICAgICAgICAgIHZhciBkYXkgPSBkYXRlLnNwbGl0KCIuIilbMl07CgogICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJ0dWktZnVsbC1jYWxlbmRhci1tb250aC1tb3JlLXRpdGxlLWRheSI+JyArCiAgICAgICAgICAgIGRheSArCiAgICAgICAgICAgICc8L3NwYW4+IDxzcGFuIGNsYXNzPSJ0dWktZnVsbC1jYWxlbmRhci1tb250aC1tb3JlLXRpdGxlLWRheS1sYWJlbCI+JyArCiAgICAgICAgICAgIGRheW5hbWUgKwogICAgICAgICAgICAiPC9zcGFuPiIKICAgICAgICAgICk7CiAgICAgICAgfSwKICAgICAgICBtb250aE1vcmVDbG9zZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICc8c3BhbiBjbGFzcz0idHVpLWZ1bGwtY2FsZW5kYXItaWNvbiB0dWktZnVsbC1jYWxlbmRhci1pYy1jbG9zZSI+PC9zcGFuPic7CiAgICAgICAgfSwKICAgICAgICBtb250aEdyaWRIZWFkZXI6IGZ1bmN0aW9uIChkYXlNb2RlbCkgewogICAgICAgICAgdmFyIGRhdGUgPSBwYXJzZUludChkYXlNb2RlbC5kYXRlLnNwbGl0KCItIilbMl0sIDEwKTsKICAgICAgICAgIHZhciBjbGFzc05hbWVzID0gWyJ0dWktZnVsbC1jYWxlbmRhci13ZWVrZGF5LWdyaWQtZGF0ZSAiXTsKCiAgICAgICAgICBpZiAoZGF5TW9kZWwuaXNUb2RheSkgewogICAgICAgICAgICBjbGFzc05hbWVzLnB1c2goInR1aS1mdWxsLWNhbGVuZGFyLXdlZWtkYXktZ3JpZC1kYXRlLWRlY29yYXRvciIpOwogICAgICAgICAgfQoKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICc8c3BhbiBjbGFzcz0iJyArIGNsYXNzTmFtZXMuam9pbigiICIpICsgJyI+JyArIGRhdGUgKyAiPC9zcGFuPiIKICAgICAgICAgICk7CiAgICAgICAgfSwKICAgICAgICBtb250aEdyaWRIZWFkZXJFeGNlZWQ6IGZ1bmN0aW9uIChoaWRkZW5TY2hlZHVsZXMpIHsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICc8c3BhbiBjbGFzcz0id2Vla2RheS1ncmlkLW1vcmUtc2NoZWR1bGVzIj4rJyArCiAgICAgICAgICAgIGhpZGRlblNjaGVkdWxlcyArCiAgICAgICAgICAgICI8L3NwYW4+IgogICAgICAgICAgKTsKICAgICAgICB9LAogICAgICAgIG1vbnRoR3JpZEZvb3RlcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICIiOwogICAgICAgIH0sCiAgICAgICAgbW9udGhHcmlkRm9vdGVyRXhjZWVkOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gIiI7CiAgICAgICAgfSwKICAgICAgICBtb250aERheW5hbWU6IGZ1bmN0aW9uIChtb2RlbCkgewogICAgICAgICAgcmV0dXJuIG1vZGVsLmxhYmVsLnRvU3RyaW5nKCkudG9Mb2NhbGVVcHBlckNhc2UoKTsKICAgICAgICB9LAogICAgICAgIHdlZWtEYXluYW1lOiBmdW5jdGlvbiAobW9kZWwpIHsKICAgICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICc8c3BhbiBjbGFzcz0idHVpLWZ1bGwtY2FsZW5kYXItZGF5bmFtZS1kYXRlIj4nICsKICAgICAgICAgICAgbW9kZWwuZGF0ZSArCiAgICAgICAgICAgICc8L3NwYW4+Jm5ic3A7Jm5ic3A7PHNwYW4gY2xhc3M9InR1aS1mdWxsLWNhbGVuZGFyLWRheW5hbWUtbmFtZSI+JyArCiAgICAgICAgICAgIG1vZGVsLmRheU5hbWUgKwogICAgICAgICAgICAiPC9zcGFuPiIKICAgICAgICAgICk7CiAgICAgICAgfSwKICAgICAgICB3ZWVrR3JpZEZvb3RlckV4Y2VlZDogZnVuY3Rpb24gKGhpZGRlblNjaGVkdWxlcykgewogICAgICAgICAgcmV0dXJuICIrIiArIGhpZGRlblNjaGVkdWxlczsKICAgICAgICB9LAogICAgICAgIGRheUdyaWRUaXRsZTogZnVuY3Rpb24gKHZpZXdOYW1lKSB7CiAgICAgICAgICAvLyB1c2UgYW5vdGhlciBmdW5jdGlvbnMgaW5zdGVhZCBvZiAnZGF5R3JpZFRpdGxlJwogICAgICAgICAgLy8gbWlsZXN0b25lVGl0bGU6IGZ1bmN0aW9uKCkgey4uLn0KICAgICAgICAgIC8vIHRhc2tUaXRsZTogZnVuY3Rpb24oKSB7Li4ufQogICAgICAgICAgLy8gYWxsZGF5VGl0bGU6IGZ1bmN0aW9uKCkgey4uLn0KCiAgICAgICAgICB2YXIgdGl0bGUgPSAiIjsKICAgICAgICAgIHN3aXRjaCAodmlld05hbWUpIHsKICAgICAgICAgICAgY2FzZSAibWlsZXN0b25lIjoKICAgICAgICAgICAgICB0aXRsZSA9CiAgICAgICAgICAgICAgICAnPHNwYW4gY2xhc3M9InR1aS1mdWxsLWNhbGVuZGFyLWxlZnQtY29udGVudCI+RVRBUEU8L3NwYW4+JzsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgY2FzZSAidGFzayI6CiAgICAgICAgICAgICAgdGl0bGUgPQogICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJ0dWktZnVsbC1jYWxlbmRhci1sZWZ0LWNvbnRlbnQiPlRBQ0hFPC9zcGFuPic7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGNhc2UgImFsbGRheSI6CiAgICAgICAgICAgICAgdGl0bGUgPQogICAgICAgICAgICAgICAgJzxzcGFuIGNsYXNzPSJ0dWktZnVsbC1jYWxlbmRhci1sZWZ0LWNvbnRlbnQiPlRvdXRlIGxhIGpvdXJuw6llPC9zcGFuPic7CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CgogICAgICAgICAgcmV0dXJuIHRpdGxlOwogICAgICAgIH0sCgogICAgICAgIGNvbGxhcHNlQnRuVGl0bGU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiAnPHNwYW4gY2xhc3M9InR1aS1mdWxsLWNhbGVuZGFyLWljb24gdHVpLWZ1bGwtY2FsZW5kYXItaWMtYXJyb3ctc29saWQtdG9wIj48L3NwYW4+JzsKICAgICAgICB9LAoKICAgICAgICB0aW1lZ3JpZERpc3BsYXlQcmltYXlUaW1lOiBmdW5jdGlvbiAodGltZSkgewogICAgICAgICAgLy8gd2lsbCBiZSBkZXByZWNhdGVkLiB1c2UgJ3RpbWVncmlkRGlzcGxheVByaW1hcnlUaW1lJwogICAgICAgICAgcmV0dXJuIHRpbWUuaG91ci50b1N0cmluZygpOwogICAgICAgIH0sCiAgICAgICAgdGltZWdyaWRDdXJyZW50VGltZTogZnVuY3Rpb24gKHRpbWV6b25lKSB7CiAgICAgICAgICB2YXIgdGVtcGxhdGVzID0gW107CgogICAgICAgICAgaWYgKHRpbWV6b25lLmRhdGVEaWZmZXJlbmNlKSB7CiAgICAgICAgICAgIHRlbXBsYXRlcy5wdXNoKAogICAgICAgICAgICAgICJbIiArCiAgICAgICAgICAgICAgICB0aW1lem9uZS5kYXRlRGlmZmVyZW5jZVNpZ24gKwogICAgICAgICAgICAgICAgdGltZXpvbmUuZGF0ZURpZmZlcmVuY2UgKwogICAgICAgICAgICAgICAgIl08YnI+IgogICAgICAgICAgICApOwogICAgICAgICAgfQoKICAgICAgICAgIHRlbXBsYXRlcy5wdXNoKG1vbWVudCh0aW1lem9uZS5ob3VybWFya2VyKS5mb3JtYXQoIkhIOm1tIikpOwoKICAgICAgICAgIHJldHVybiB0ZW1wbGF0ZXMuam9pbigiIik7CiAgICAgICAgfSwKICAgICAgICBwb3B1cElzQWxsRGF5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gIlRvdXRlIGxhIGpvdXJuw6llIjsKICAgICAgICB9LAogICAgICAgIHBvcHVwU3RhdGVGcmVlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gIkxpYnJlIjsKICAgICAgICB9LAogICAgICAgIHBvcHVwU3RhdGVCdXN5OiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gIk9jY3Vww6kiOwogICAgICAgIH0sCiAgICAgICAgdGl0bGVQbGFjZWhvbGRlcjogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICJTdWpldCI7CiAgICAgICAgfSwKICAgICAgICBsb2NhdGlvblBsYWNlaG9sZGVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gIkxpZXUiOwogICAgICAgIH0sCiAgICAgICAgc3RhcnREYXRlUGxhY2Vob2xkZXI6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiAiRGF0ZSBkZSBEw6lidXQiOwogICAgICAgIH0sCiAgICAgICAgZW5kRGF0ZVBsYWNlaG9sZGVyOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gIkRhdGUgZGUgZmluIjsKICAgICAgICB9LAogICAgICAgIHBvcHVwU2F2ZTogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuICJWYWxpZGVyIjsKICAgICAgICB9LAogICAgICAgIHBvcHVwVXBkYXRlOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICByZXR1cm4gIk1ldHRyZSDDoCBqb3VyIjsKICAgICAgICB9LAogICAgICAgIHBvcHVwRGV0YWlsRGF0ZTogZnVuY3Rpb24gKGlzQWxsRGF5LCBzdGFydCwgZW5kKSB7CiAgICAgICAgICB2YXIgaXNTYW1lRGF0ZSA9IG1vbWVudChzdGFydCkuaXNTYW1lKGVuZCk7CiAgICAgICAgICB2YXIgZW5kRm9ybWF0ID0gKGlzU2FtZURhdGUgPyAiIiA6ICJZWVlZL01NL0REICIpICsgIkhIOm1tIjsKCiAgICAgICAgICBpZiAoaXNBbGxEYXkpIHsKICAgICAgICAgICAgcmV0dXJuICgKICAgICAgICAgICAgICBtb21lbnQoc3RhcnQpLmZvcm1hdCgiWVlZWS9NTS9ERCIpICsKICAgICAgICAgICAgICAoaXNTYW1lRGF0ZSA/ICIiIDogIiAtICIgKyBtb21lbnQoZW5kKS5mb3JtYXQoIllZWVkvTU0vREQiKSkKICAgICAgICAgICAgKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gKAogICAgICAgICAgICBtb21lbnQoc3RhcnQudG9EYXRlKCkpLmZvcm1hdCgiWVlZWS9NTS9ERCBISDptbSIpICsKICAgICAgICAgICAgIiAtICIgKwogICAgICAgICAgICBtb21lbnQoZW5kLnRvRGF0ZSgpKS5mb3JtYXQoZW5kRm9ybWF0KQogICAgICAgICAgKTsKICAgICAgICB9LAogICAgICAgIHBvcHVwRGV0YWlsTG9jYXRpb246IGZ1bmN0aW9uIChzY2hlZHVsZSkgewogICAgICAgICAgcmV0dXJuICJMaWV1IDogIiArIHNjaGVkdWxlLmxvY2F0aW9uOwogICAgICAgIH0sCiAgICAgICAgLy8gcG9wdXBEZXRhaWxVc2VyOiBmdW5jdGlvbiAoc2NoZWR1bGUpIHsKICAgICAgICAvLyAJcmV0dXJuICdTdGFmZiA6ICcgKyAoc2NoZWR1bGUuYXR0ZW5kZWVzIHx8IFtdKS5qb2luKCcsICcpCiAgICAgICAgLy8gfSwKICAgICAgICBwb3B1cERldGFpbFN0YXRlOiBmdW5jdGlvbiAoc2NoZWR1bGUpIHsKICAgICAgICAgIHJldHVybiAiIFN0YXR1dDogIiArIHNjaGVkdWxlLnN0YXRlID09PSAiRnJlZSIgPyAiTGlicmUiIDogIk9jY3Vww6kiOwogICAgICAgIH0sCiAgICAgICAgcG9wdXBEZXRhaWxSZXBlYXQ6IGZ1bmN0aW9uIChzY2hlZHVsZSkgewogICAgICAgICAgcmV0dXJuICJSZXBlYXQgOiAiICsgc2NoZWR1bGUucmVjdXJyZW5jZVJ1bGU7CiAgICAgICAgfSwKICAgICAgICBwb3B1cERldGFpbEJvZHk6IGZ1bmN0aW9uIChzY2hlZHVsZSkgewogICAgICAgICAgcmV0dXJuICJCb2R5IDogIiArIHNjaGVkdWxlLmJvZHk7CiAgICAgICAgfSwKICAgICAgICBwb3B1cEVkaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiAiTW9kaWZpZXIiOwogICAgICAgIH0sCiAgICAgICAgcG9wdXBEZWxldGU6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHJldHVybiAiU3VwcHJpbWVyIjsKICAgICAgICB9LAogICAgICB9OwogICAgfSwKICAgIF9nZXRUaW1lVGVtcGxhdGUoc2NoZWR1bGUsIGlzQWxsRGF5KSB7CiAgICAgIHZhciBodG1sID0gW107CgogICAgICBpZiAoIWlzQWxsRGF5KSB7CiAgICAgICAgaHRtbC5wdXNoKAogICAgICAgICAgIjxzdHJvbmc+IiArCiAgICAgICAgICAgIG1vbWVudChzY2hlZHVsZS5zdGFydC50b0RhdGUoKSkuZm9ybWF0KCJISDptbSIpICsKICAgICAgICAgICAgIjwvc3Ryb25nPiAiCiAgICAgICAgKTsKICAgICAgfQogICAgICBpZiAoc2NoZWR1bGUuaXNQcml2YXRlKSB7CiAgICAgICAgaHRtbC5wdXNoKCc8c3BhbiBjbGFzcz0iY2FsZW5kYXItZm9udC1pY29uIGljLWxvY2stYiI+PC9zcGFuPicpOwogICAgICAgIGh0bWwucHVzaCgiIFByaXZhdGUiKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAoc2NoZWR1bGUuaXNSZWFkT25seSkgewogICAgICAgICAgaHRtbC5wdXNoKCc8c3BhbiBjbGFzcz0iY2FsZW5kYXItZm9udC1pY29uIGljLXJlYWRvbmx5LWIiPjwvc3Bhbj4nKTsKICAgICAgICB9IGVsc2UgaWYgKHNjaGVkdWxlLnJlY3VycmVuY2VSdWxlKSB7CiAgICAgICAgICBodG1sLnB1c2goJzxzcGFuIGNsYXNzPSJjYWxlbmRhci1mb250LWljb24gaWMtcmVwZWF0LWIiPjwvc3Bhbj4nKTsKICAgICAgICB9IGVsc2UgaWYgKHNjaGVkdWxlLmF0dGVuZGVlcy5sZW5ndGgpIHsKICAgICAgICAgIGh0bWwucHVzaCgnPHNwYW4gY2xhc3M9ImNhbGVuZGFyLWZvbnQtaWNvbiBpYy11c2VyLWIiPjwvc3Bhbj4nKTsKICAgICAgICB9IGVsc2UgaWYgKHNjaGVkdWxlLmxvY2F0aW9uKSB7CiAgICAgICAgICBodG1sLnB1c2goJzxzcGFuIGNsYXNzPSJjYWxlbmRhci1mb250LWljb24gaWMtbG9jYXRpb24tYiI+PC9zcGFuPicpOwogICAgICAgIH0KCiAgICAgICAgaHRtbC5wdXNoKCIgIiArIHNjaGVkdWxlLnRpdGxlKTsKICAgICAgfQoKICAgICAgcmV0dXJuIGh0bWwuam9pbigiIik7CiAgICB9LAoKICAgIHNldFJlbmRlclJhbmdlVGV4dCgpIHsKICAgICAgbGV0IG9wdGlvbnMgPSB0aGlzLiRyZWZzLnR1aUNhbGVuZGFyLmludm9rZSgiZ2V0T3B0aW9ucyIpOwogICAgICBsZXQgdmlld05hbWUgPSB0aGlzLiRyZWZzLnR1aUNhbGVuZGFyLmludm9rZSgiZ2V0Vmlld05hbWUiKTsKICAgICAgbGV0IGh0bWwgPSBbXTsKICAgICAgdGhpcy5zdGFydERhdGUgPSB0aGlzLiRyZWZzLnR1aUNhbGVuZGFyCiAgICAgICAgLmludm9rZSgiZ2V0RGF0ZVJhbmdlU3RhcnQiKQogICAgICAgIC50b0RhdGUoKQogICAgICAgIC50b0xvY2FsZURhdGVTdHJpbmcoImZyLUNBIik7CiAgICAgIHRoaXMuZW5kRGF0ZSA9IHRoaXMuJHJlZnMudHVpQ2FsZW5kYXIKICAgICAgICAuaW52b2tlKCJnZXREYXRlUmFuZ2VFbmQiKQogICAgICAgIC50b0RhdGUoKQogICAgICAgIC50b0xvY2FsZURhdGVTdHJpbmcoImZyLUNBIik7CgogICAgICBpZiAodmlld05hbWUgPT09ICJkYXkiKSB7CiAgICAgICAgaHRtbC5wdXNoKHRoaXMuY3VycmVudENhbGVuZGFyRGF0ZSgiREQgTU1NTSBZWVlZIikpOwogICAgICB9IGVsc2UgaWYgKAogICAgICAgIHZpZXdOYW1lID09PSAibW9udGgiICYmCiAgICAgICAgKCFvcHRpb25zLm1vbnRoLnZpc2libGVXZWVrc0NvdW50IHx8CiAgICAgICAgICBvcHRpb25zLm1vbnRoLnZpc2libGVXZWVrc0NvdW50ID4gNCkKICAgICAgKSB7CiAgICAgICAgaHRtbC5wdXNoKHRoaXMuY3VycmVudENhbGVuZGFyRGF0ZSgiTU1NTSBZWVlZIikpOwogICAgICB9IGVsc2UgewogICAgICAgIGxldCB0aW1lID0gbW9tZW50KAogICAgICAgICAgdGhpcy4kcmVmcy50dWlDYWxlbmRhci5pbnZva2UoImdldERhdGVSYW5nZVN0YXJ0IikuZ2V0VGltZSgpCiAgICAgICAgKTsKCiAgICAgICAgbGV0IGN1cnJlbnRkYXRlID0gbmV3IERhdGUodGltZSk7CiAgICAgICAgbGV0IG9uZUphbiA9IG5ldyBEYXRlKGN1cnJlbnRkYXRlLmdldEZ1bGxZZWFyKCksIDAsIDEpOwogICAgICAgIGxldCBudW1iZXJPZkRheXMgPSBNYXRoLmZsb29yKAogICAgICAgICAgKGN1cnJlbnRkYXRlIC0gb25lSmFuKSAvICgyNCAqIDYwICogNjAgKiAxMDAwKQogICAgICAgICk7CiAgICAgICAgbGV0IHJlc3VsdCA9IE1hdGguY2VpbCgoY3VycmVudGRhdGUuZ2V0RGF5KCkgKyAxICsgbnVtYmVyT2ZEYXlzKSAvIDcpOwogICAgICAgIGh0bWwucHVzaCgKICAgICAgICAgICJTZW1haW5lICIgKwogICAgICAgICAgICByZXN1bHQgKwogICAgICAgICAgICAiIHwgIiArCiAgICAgICAgICAgIG1vbWVudCh0aGlzLiRyZWZzLnR1aUNhbGVuZGFyLmludm9rZSgiZ2V0RGF0ZVJhbmdlU3RhcnQiKS5nZXRUaW1lKCkpCiAgICAgICAgICAgICAgLmxvY2FsZSh0aGlzLmxvY2FsZSkKICAgICAgICAgICAgICAuZm9ybWF0KCJERCBNTU1NIFlZWVkiKQogICAgICAgICk7CiAgICAgICAgaHRtbC5wdXNoKCIgLSAiKTsKICAgICAgICBodG1sLnB1c2goCiAgICAgICAgICBtb21lbnQodGhpcy4kcmVmcy50dWlDYWxlbmRhci5pbnZva2UoImdldERhdGVSYW5nZUVuZCIpLmdldFRpbWUoKSkKICAgICAgICAgICAgLmxvY2FsZSh0aGlzLmxvY2FsZSkKICAgICAgICAgICAgLmZvcm1hdCgiREQgTU1NTSBZWVlZIikKICAgICAgICApOwogICAgICB9CiAgICAgIHRoaXMucmVuZGVyUmFuZ2UgPSBodG1sLmpvaW4oIiIpOwogICAgfSwKICAgIGdlbmVyYXRlUXVlcnlGb3IoZGF0YUFycmF5LCBkYXRhUGFyYW0sIHJlc3VsdCkgewogICAgICBpZiAoZGF0YUFycmF5Lmxlbmd0aCA+IDApIHsKICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KAogICAgICAgICAgcmVzdWx0Lmxlbmd0aCA9PT0gMCA/ICJjb25kaXRpb246IiA6ICI6c2VwYXJhdG9yOkFORDpjb25kaXRpb246IiwKICAgICAgICAgIHRoaXMuc2V0ZmlsdGVyKGRhdGFBcnJheSwgZGF0YVBhcmFtKQogICAgICAgICk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgICBnZXRRdWVyeVBhcmFtKGRhdGVGaWx0ZXIgPSAiZGF0ZV9hY3Rpb24iKSB7CiAgICAgIC8qKgogICAgICAgKkBwYXJhbSBub25lCiAgICAgICAqQGF1dGhvciBKYWNxdWVzCiAgICAgICAqQFJlc3VtZSA6IGZpZ3VyZSBvdXQgIGZpbHRlciBvbiBBUEkgcmVxdWVzdAogICAgICAgKkBleGFtcGxlIDogY29uZGl0aW9uOmlkdXRpbGlzYXRldXI6ZWdhbDoxOk9SOmlkdXRpbGlzYXRldXI6ZWdhbDo0OnNlcGFyYXRvcjpBTkQ6Y29uZGl0aW9uOmlkcHJvamV0OmVnYWw6MTpPUjppZHByb2pldDplZ2FsOjQwNjA6c2VwYXJhdG9yOkFORDpjb25kaXRpb246aWRzb2NpZXRlOmVnYWw6NDpPUjppZHNvY2lldGU6ZWdhbDoyMjM0CiAgICAgICAqKi8KCiAgICAgIGxldCBmaWx0ZXIgPSAiIjsKICAgICAgLy8gZmlsdGVyaW5nIHVzZXJzCiAgICAgIGlmICh0aGlzLnNlbGVjdGVkVXNlcnMubGVuZ3RoID4gMCkgewogICAgICAgIGZpbHRlciA9IGZpbHRlci5jb25jYXQoCiAgICAgICAgICBmaWx0ZXIubGVuZ3RoID09PSAwID8gImNvbmRpdGlvbjoiIDogIjpzZXBhcmF0b3I6QU5EOmNvbmRpdGlvbjoiLAogICAgICAgICAgdGhpcy5zZXRmaWx0ZXIoCiAgICAgICAgICAgIHRoaXMuc2VsZWN0ZWRVc2Vycy5tYXAoKGUpID0+IHsKICAgICAgICAgICAgICByZXR1cm4gZS5pZDsKICAgICAgICAgICAgfSksCiAgICAgICAgICAgICJpZHV0aWxpc2F0ZXVyIgogICAgICAgICAgKQogICAgICAgICk7CiAgICAgIH0KCiAgICAgIC8vIGlkcHJvamV0CiAgICAgIGlmICh0aGlzLmlkcHJvamV0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgZmlsdGVyID0gZmlsdGVyLmNvbmNhdCgKICAgICAgICAgIGZpbHRlci5sZW5ndGggPT09IDAgPyAiY29uZGl0aW9uOiIgOiAiOnNlcGFyYXRvcjpBTkQ6Y29uZGl0aW9uOiIsCiAgICAgICAgICB0aGlzLnNldGZpbHRlcih0aGlzLmlkcHJvamV0cywgImlkcHJvamV0IikKICAgICAgICApOwogICAgICB9CgogICAgICAvLyBpZGNvbnRhY3QKICAgICAgaWYgKHRoaXMuaWRjb250YWN0cy5sZW5ndGggPiAwKSB7CiAgICAgICAgZmlsdGVyID0gZmlsdGVyLmNvbmNhdCgKICAgICAgICAgIGZpbHRlci5sZW5ndGggPT09IDAgPyAiY29uZGl0aW9uOiIgOiAiOnNlcGFyYXRvcjpBTkQ6Y29uZGl0aW9uOiIsCiAgICAgICAgICB0aGlzLnNldGZpbHRlcih0aGlzLmlkY29udGFjdHMsICJpZGNvbnRhY3QiKQogICAgICAgICk7CiAgICAgIH0KCiAgICAgIC8vIGlkc29jaWV0ZQogICAgICBpZiAodGhpcy5pZHNvY2lldGVzLmxlbmd0aCA+IDApIHsKICAgICAgICBmaWx0ZXIgPSBmaWx0ZXIuY29uY2F0KAogICAgICAgICAgZmlsdGVyLmxlbmd0aCA9PT0gMCA/ICJjb25kaXRpb246IiA6ICI6c2VwYXJhdG9yOkFORDpjb25kaXRpb246IiwKICAgICAgICAgIHRoaXMuc2V0ZmlsdGVyKHRoaXMuaWRzb2NpZXRlcywgImlkc29jaWV0ZSIpCiAgICAgICAgKTsKICAgICAgfQoKICAgICAgLy8gU2V0dGluZyBjb25kaXRpb24gb24gRGF0ZXMKCiAgICAgIGZpbHRlciA9IGZpbHRlci5jb25jYXQoCiAgICAgICAgZmlsdGVyLmxlbmd0aCA9PT0gMCA/ICJjb25kaXRpb246IiA6ICI6c2VwYXJhdG9yOkFORDpjb25kaXRpb246IiwKICAgICAgICBkYXRlRmlsdGVyICsKICAgICAgICAgICI6YmlnZ2VydGhhbm9yZWdhbDoiICsKICAgICAgICAgIHRoaXMuc3RhcnREYXRlICsKICAgICAgICAgICI6QU5EOiIgKwogICAgICAgICAgZGF0ZUZpbHRlciArCiAgICAgICAgICAiOmxvd2VydGhhbm9yZWdhbDoiICsKICAgICAgICAgIHRoaXMuZW5kRGF0ZQogICAgICApOwoKICAgICAgcmV0dXJuIGZpbHRlcjsKICAgIH0sCiAgICBzZXRmaWx0ZXIobGlzdEFycmF5LCBwYXJhbSkgewogICAgICBpZiAobGlzdEFycmF5Lmxlbmd0aCA9PT0gMSkgewogICAgICAgIHJldHVybiBwYXJhbSArICI6ZWdhbDoiICsgbGlzdEFycmF5WzBdOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiAoCiAgICAgICAgICBwYXJhbSArCiAgICAgICAgICAiOmVnYWw6IiArCiAgICAgICAgICBsaXN0QXJyYXlbMF0gKwogICAgICAgICAgIjpPUjoiICsKICAgICAgICAgIHRoaXMuc2V0ZmlsdGVyKGxpc3RBcnJheS5zbGljZSgxKSwgcGFyYW0pCiAgICAgICAgKTsKICAgICAgfQogICAgfSwKCiAgICBhc3luYyBnZXRDYWxlbmRhckl0ZW0obmJQYWdlID0gMCwgb25EdWVEYXRlID0gZmFsc2UpIHsKICAgICAgcmV0dXJuIGF4aW9zKHsKICAgICAgICBtZXRob2Q6ICJnZXQiLAogICAgICAgIHVybDoKICAgICAgICAgIHRoaXMuVVJJICsKICAgICAgICAgIHRoaXMuQVBJX0tFWSArCiAgICAgICAgICAiLyIgKwogICAgICAgICAgdGhpcy5nZXRRdWVyeVBhcmFtKG9uRHVlRGF0ZSA/ICJkYXRlX2VjaGVhbmNlIiA6ICJkYXRlX2FjdGlvbiIpICsKICAgICAgICAgICIvIiArCiAgICAgICAgICBuYlBhZ2UsCiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICB9LAogICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmRhdGEubGVuZ3RoID4gMCkgewogICAgICAgICAgbGV0IHJlc3VsdCA9IHJlc3BvbnNlLmRhdGEuZGF0YS5tYXAoKGVsZW1lbnQpID0+IHsKICAgICAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgICBzdGFydDogZWxlbWVudC5kYXRlX2FjdGlvbi52YWx1ZSwKICAgICAgICAgICAgICBlbmQ6IGVsZW1lbnQuZGF0ZV9maW4udmFsdWUsCiAgICAgICAgICAgICAgaXNSZWFkT25seTogZWxlbWVudC5lX2xvY2sudmFsdWUgPT09ICIxIiwKICAgICAgICAgICAgICBsb2NhdGlvbjogZWxlbWVudC5sb2NhdGlvbi52YWx1ZSwKICAgICAgICAgICAgICBpZGFjdGlvbjogZWxlbWVudC5pZGFjdGlvbi52YWx1ZSwKICAgICAgICAgICAgICB0aXRsZTogZWxlbWVudC5zdWpldC52YWx1ZSwKICAgICAgICAgICAgICBiZ0NvbG9yOgogICAgICAgICAgICAgICAgb25EdWVEYXRlICYmIHRoaXMudHlwZXZpZXcuaW5kZXggIT0gImNvbG9yX3ByaW9yaXRlIgogICAgICAgICAgICAgICAgICA/ICIjZjJhNjQwIgogICAgICAgICAgICAgICAgICA6IHRoaXMuc2V0Q29sb3IodGhpcy50eXBldmlldywgZWxlbWVudCksCiAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJ0aW1lIiwKICAgICAgICAgICAgICBkdWVEYXRlQ2xhc3M6IGVsZW1lbnQuZGF0ZV9lY2hlYW5jZS52YWx1ZSwKICAgICAgICAgICAgICBpZDogZWxlbWVudC5pZGFjdGlvbi52YWx1ZS50b1N0cmluZygpLAogICAgICAgICAgICAgIGNhbGVuZGFySWQ6CiAgICAgICAgICAgICAgICB0aGlzLmdldENhbGVuZGFySWRXaXRoQ29sb3IoZWxlbWVudC5jb2xvci52YWx1ZSkgfHwgIjAiLAogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoWwogICAgICAgICAgICAuLi5yZXN1bHQsCiAgICAgICAgICAgIHRoaXMuZ2V0Q2FsZW5kYXJJdGVtKCsrbmJQYWdlLCBvbkR1ZURhdGUpLAogICAgICAgICAgXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBbXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIGdldEl0ZXJhY3Rpb25zSGlzdG9yeShuYlBhZ2UgPSAwKSB7CiAgICAgIHJldHVybiBheGlvcyh7CiAgICAgICAgbWV0aG9kOiAiZ2V0IiwKICAgICAgICB1cmw6CiAgICAgICAgICB0aGlzLlVSSV9ISVNUT1JZICsKICAgICAgICAgIHRoaXMuQVBJX0tFWSArCiAgICAgICAgICAiLyIgKwogICAgICAgICAgdGhpcy5nZXRRdWVyeVBhcmFtKCkgKwogICAgICAgICAgIi8iICsKICAgICAgICAgIG5iUGFnZSwKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgIH0sCiAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuZGF0YS5sZW5ndGggPiAwKSB7CiAgICAgICAgICAvL2xldCBpbmRleCA9IDA7CiAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVzcG9uc2UuZGF0YS5kYXRhLm1hcCgoZWxlbWVudCkgPT4gewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgIHN0YXJ0OiBlbGVtZW50LmRhdGVfYWN0aW9uLnZhbHVlLAogICAgICAgICAgICAgIGVuZDogZWxlbWVudC5kYXRlX2Zpbi52YWx1ZSwKICAgICAgICAgICAgICBpc1JlYWRPbmx5OiBlbGVtZW50LmVfbG9jay52YWx1ZSA9PT0gIjEiLAogICAgICAgICAgICAgIGxvY2F0aW9uOiBlbGVtZW50LmxvY2F0aW9uLnZhbHVlLAogICAgICAgICAgICAgIGlkYWN0aW9uOiBlbGVtZW50LmlkYWN0aW9uLnZhbHVlLAogICAgICAgICAgICAgIC8vICAgc3RhdGU6IGVsZW1lbnQuZXRhdC52YWx1ZSA9PT0gMCA/ICJCdXN5IiA6ICJGcmVlIiwKICAgICAgICAgICAgICB0aXRsZTogZWxlbWVudC5zdWpldC52YWx1ZSwKICAgICAgICAgICAgICBiZ0NvbG9yOiAiIzhjYmY0MCIsIC8vIHRoaXMuc2V0Q29sb3IodGhpcy50eXBldmlldywgZWxlbWVudCksCiAgICAgICAgICAgICAgY2F0ZWdvcnk6ICJ0aW1lIiwKICAgICAgICAgICAgICAvLyBjb2xvcjogdGhpcy5zZXRDb2xvcih0aGlzLnR5cGV2aWV3LCBlbGVtZW50KSwKICAgICAgICAgICAgICBkdWVEYXRlQ2xhc3M6IGVsZW1lbnQuZGF0ZV9lY2hlYW5jZS52YWx1ZSwKICAgICAgICAgICAgICBpZDogZWxlbWVudC5pZGFjdGlvbi52YWx1ZS50b1N0cmluZygpLAogICAgICAgICAgICAgIGNhbGVuZGFySWQ6CiAgICAgICAgICAgICAgICB0aGlzLmdldENhbGVuZGFySWRXaXRoQ29sb3IoZWxlbWVudC5jb2xvci52YWx1ZSkgfHwgIjAiLAogICAgICAgICAgICB9OwogICAgICAgICAgfSk7CiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5hbGwoWy4uLnJlc3VsdCwgdGhpcy5nZXRJdGVyYWN0aW9uc0hpc3RvcnkoKytuYlBhZ2UpXSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBbXTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIGN1cnJlbnRDYWxlbmRhckRhdGUoZm9ybWF0KSB7CiAgICAgIHZhciBjdXJyZW50RGF0ZSA9IG1vbWVudChbCiAgICAgICAgdGhpcy4kcmVmcy50dWlDYWxlbmRhci5pbnZva2UoImdldERhdGUiKS5nZXRGdWxsWWVhcigpLAogICAgICAgIHRoaXMuJHJlZnMudHVpQ2FsZW5kYXIuaW52b2tlKCJnZXREYXRlIikuZ2V0TW9udGgoKSwKICAgICAgICB0aGlzLiRyZWZzLnR1aUNhbGVuZGFyLmludm9rZSgiZ2V0RGF0ZSIpLmdldERhdGUoKSwKICAgICAgXSk7CgogICAgICAvLyBmaXJzdCBsZXR0ZXIgdXBwZXJjYXNlCiAgICAgIHJldHVybiAoCiAgICAgICAgY3VycmVudERhdGUubG9jYWxlKHRoaXMubG9jYWxlKS5mb3JtYXQoZm9ybWF0KS5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArCiAgICAgICAgY3VycmVudERhdGUubG9jYWxlKHRoaXMubG9jYWxlKS5mb3JtYXQoZm9ybWF0KS5zbGljZSgxKQogICAgICApOwogICAgfSwKICAgIGdldENhbGVuZGFyV2l0aENvbG9yKGNvbG9yKSB7CiAgICAgIC8vIGdldCBpbmRleAogICAgICBsZXQgaW5kZXggPSB0aGlzLmNhbGVuZGFyTGlzdC5maW5kSW5kZXgoCiAgICAgICAgKGVsZW1lbnQpID0+IGVsZW1lbnQuYmdDb2xvciA9PT0gY29sb3IKICAgICAgKTsKICAgICAgLy8gcmV0dXJuIGNhbGVuZGFyCiAgICAgIHJldHVybiB0aGlzLmNhbGVuZGFyTGlzdFtpbmRleF0/LmJnQ29sb3IgfHwgIiNGRkYiOwogICAgfSwKICAgIGdldENhbGVuZGFySWRXaXRoQ29sb3IoY29sb3IpIHsKICAgICAgLy8gZ2V0IGluZGV4CiAgICAgIGxldCBpbmRleCA9IHRoaXMuY2FsZW5kYXJMaXN0LmZpbmRJbmRleCgKICAgICAgICAoZWxlbWVudCkgPT4gZWxlbWVudC5iZ0NvbG9yID09PSBjb2xvcgogICAgICApOwogICAgICAvLyByZXR1cm4gY2FsZW5kYXIKICAgICAgcmV0dXJuIHRoaXMuY2FsZW5kYXJMaXN0W2luZGV4XT8uaWQ7CiAgICB9LAogICAgZ2V0VG9kYXkoKSB7CiAgICAgIHRoaXMuJHJlZnMudHVpQ2FsZW5kYXIuaW52b2tlKCJ0b2RheSIpOwogICAgICB0aGlzLnNldFJlbmRlclJhbmdlVGV4dCgpOwogICAgICB0aGlzLmRpc3BhdGNoQWN0aW9uKCk7CiAgICB9LAogICAgbmV4dCgpIHsKICAgICAgdGhpcy4kcmVmcy50dWlDYWxlbmRhci5pbnZva2UoIm5leHQiKTsKICAgICAgdGhpcy5zZXRSZW5kZXJSYW5nZVRleHQoKTsKICAgICAgdGhpcy5kaXNwYXRjaEFjdGlvbigpOwogICAgfSwKICAgIHByZXYoKSB7CiAgICAgIHRoaXMuJHJlZnMudHVpQ2FsZW5kYXIuaW52b2tlKCJwcmV2Iik7CiAgICAgIHRoaXMuc2V0UmVuZGVyUmFuZ2VUZXh0KCk7CiAgICAgIHRoaXMuZGlzcGF0Y2hBY3Rpb24oKTsKICAgIH0sCiAgICB0b2RheSgpIHsKICAgICAgdGhpcy4kcmVmcy50dWlDYWxlbmRhci5pbnZva2UoInRvZGF5Iik7CiAgICAgIHRoaXMuc2V0UmVuZGVyUmFuZ2VUZXh0KCk7CiAgICAgIHRoaXMuZGlzcGF0Y2hBY3Rpb24oKTsKICAgIH0sCiAgICBjaGFuZ2VWaWV3KHZpZXdOYW1lKSB7CiAgICAgIHRoaXMuJHJlZnMudHVpQ2FsZW5kYXIuaW52b2tlKCJjaGFuZ2VWaWV3Iiwgdmlld05hbWUpOwogICAgfSwKICAgIG9uQ2xpY2tTY2hlZHVsZShyZXMpIHsKICAgICAgdGhpcy5zZWxlY3RlZCA9IHJlczsKCiAgICAgIC8vIHNldCBtb3JlIGNhcmQgdG8gZGlzcGxheSBub25lCiAgICAgIGxldCBjYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSgKICAgICAgICAidHVpLWZ1bGwtY2FsZW5kYXItbW9udGgtbW9yZSIKICAgICAgKTsKICAgICAgY2FyZFswXS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOwogICAgfSwKICAgIG9uQ2xpY2tEYXluYW1lKHJlcykgewogICAgICAvLyB2aWV3IDogd2VlaywgZGF5CiAgICAgIGNvbnNvbGUuZ3JvdXAoIm9uQ2xpY2tEYXluYW1lIik7CiAgICAgIGNvbnNvbGUubG9nKHJlcy5kYXRlKTsKICAgICAgY29uc29sZS5ncm91cEVuZCgpOwogICAgfSwKCiAgICBvbkJlZm9yZUNyZWF0ZVNjaGVkdWxlKGUpIHsKICAgICAgdGhpcy5ldmVudCA9IGU7CiAgICAgIGNvbnN0IGV2ZW50RGF0ZSA9IGUuc3RhcnQudG9EYXRlKCk7CiAgICAgIHRoaXMuZGF0ZUNyZWF0ZUV2ZW50ID0KICAgICAgICBldmVudERhdGUudG9Mb2NhbGVEYXRlU3RyaW5nKCJmci1DQSIpICsKICAgICAgICAiXyIgKwogICAgICAgIChldmVudERhdGUuZ2V0SG91cnMoKSA8IDEwID8gIjAiIDogIiIpICsKICAgICAgICBldmVudERhdGUuZ2V0SG91cnMoKSArCiAgICAgICAgIi0iICsKICAgICAgICAoZXZlbnREYXRlLmdldE1pbnV0ZXMoKSA8IDEwID8gIjAiIDogIiIpICsKICAgICAgICBldmVudERhdGUuZ2V0TWludXRlcygpOwogICAgICBlLmd1aWRlLmNsZWFyR3VpZGVFbGVtZW50KCk7CiAgICAgIHRoaXMuY2xpY2tDb3VudCA9IHRoaXMuY2xpY2tDb3VudCA9PT0gMCA/IDEgOiAwOwogICAgICB0aGlzLmNyZWF0aW5nID0gdGhpcy5jbGlja0NvdW50ID09PSAwOwogICAgICBzZXRUaW1lb3V0KCgpID0+IHsKICAgICAgICB0aGlzLm9wZW5JZnJhbWVFZGl0b3IoKTsKICAgICAgfSwgNTApOwogICAgfSwKICAgIG9uQmVmb3JlVXBkYXRlU2NoZWR1bGUoZSkgewogICAgICB2YXIgZW0gPSB0aGlzOwoKICAgICAgbGV0IHNjaGVkdWxlID0gdGhpcy5Dc2NoZWR1bGVMaXN0LmZpbmQoCiAgICAgICAgKGVsZW1lbnQpID0+IGVsZW1lbnQuaWQgPT09IGUuc2NoZWR1bGUuaWQKICAgICAgKTsKCiAgICAgIGUuc2NoZWR1bGUuc3RhcnQgPSBlLnN0YXJ0OwogICAgICBlLnNjaGVkdWxlLmVuZCA9IGUuZW5kOwogICAgICBzY2hlZHVsZS5jYWxlbmRhcklkID0gZS5jaGFuZ2VzLmNhbGVuZGFySWQgfHwgZS5zY2hlZHVsZS5jYWxlbmRhcklkOwogICAgICBzY2hlZHVsZS50aXRsZSA9IGUuY2hhbmdlcy50aXRsZSB8fCBlLnNjaGVkdWxlLnRpdGxlOwogICAgICBzY2hlZHVsZS5jYXRlZ29yeSA9IGUuY2hhbmdlcy5pc0FsbERheQogICAgICAgID8gImFsbGRheSIKICAgICAgICA6ICJ0aW1lIiB8fCBlLmNoYW5nZXMuY2F0ZWdvcnk7CgogICAgICBzY2hlZHVsZS5zdGFydCA9IGUuc3RhcnQ7CiAgICAgIHNjaGVkdWxlLmVuZCA9IGUuZW5kOwogICAgICBzY2hlZHVsZS5pc1JlYWRPbmx5ID0gZS5jaGFuZ2VzLmlzUHJpdmF0ZSB8fCBlLmNoYW5nZXMuaXNSZWFkT25seTsKICAgICAgc2NoZWR1bGUubG9jYXRpb24gPSBlLmNoYW5nZXMubG9jYXRpb24gfHwgZS5zY2hlZHVsZS5sb2NhdGlvbjsKICAgICAgc2NoZWR1bGUuYmdDb2xvciA9CiAgICAgICAgdGhpcy5jYWxlbmRhckxpc3RbCiAgICAgICAgICBlLmNoYW5nZXMuY2FsZW5kYXJJZCB8fCBlLnNjaGVkdWxlLmNhbGVuZGFySWQKICAgICAgICBdLmJnQ29sb3I7CgogICAgICB2YXIgdCA9IG5ldyBEYXRlKGUuc2NoZWR1bGUuc3RhcnQpLnRvSVNPU3RyaW5nKCk7CiAgICAgIHQgPSBTdHJpbmcodCkucmVwbGFjZSgiVCIsICIgIik7CiAgICAgIHQgPSBTdHJpbmcodCkucmVwbGFjZSgiLjAwMFoiLCAiIik7CgogICAgICBjb25zdCB0aW1lX2RpZmZlcmVuY2UgPSBlLmVuZC5nZXRUaW1lKCkgLSBlLnN0YXJ0LmdldFRpbWUoKTsKICAgICAgLy9jYWxjdWxhdGUgZGF5cyBkaWZmZXJlbmNlIGJ5IGRpdmlkaW5nIHRvdGFsIG1pbGxpc2Vjb25kcyBpbiBhIGRheQogICAgICBjb25zdCBob3VycyA9IE1hdGguZmxvb3IodGltZV9kaWZmZXJlbmNlIC8gKDEwMDAgKiA2MCAqIDYwKSk7CiAgICAgIGNvbnN0IHJlbWFpbmluZ19taWxsaXNlY29uZHMgPSB0aW1lX2RpZmZlcmVuY2UgJSAoMTAwMCAqIDYwICogNjApOwogICAgICBjb25zdCBtaW51dGVzID0gTWF0aC5mbG9vcihyZW1haW5pbmdfbWlsbGlzZWNvbmRzIC8gKDEwMDAgKiA2MCkpOwoKICAgICAgdmFyIGNvbmZpZyA9IHsKICAgICAgICBtZXRob2Q6ICJwdXQiLAogICAgICAgIHVybDogdGhpcy5VUklfQUNUSU9OICsgdGhpcy5BUElfS0VZLAoKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAiQ29udGVudC1UeXBlIjogImFwcGxpY2F0aW9uL2pzb24iLAogICAgICAgIH0sCiAgICAgICAgZGF0YTogSlNPTi5zdHJpbmdpZnkoewogICAgICAgICAgaWRhY3Rpb246IHNjaGVkdWxlLmlkYWN0aW9uLAogICAgICAgICAgc3VqZXQ6IHNjaGVkdWxlLnRpdGxlLAogICAgICAgICAgYWxsX2RheTogc2NoZWR1bGUuY2F0ZWdvcnkgPT0gImFsbGRheSIgPyAxIDogMCwKICAgICAgICAgIGRhdGVfYWN0aW9uOiB0LAogICAgICAgICAgZHVyZWVfaGV1cmVzOiBob3VycywKICAgICAgICAgIGR1cmVlX21pbnV0ZXM6IG1pbnV0ZXMsCiAgICAgICAgICBsb2NhdGlvbjogc2NoZWR1bGUubG9jYXRpb24sCiAgICAgICAgICAvLyAgICBldGF0OiBzY2hlZHVsZS5zdGF0ZSA9PSAiQnVzeSIgPyAxIDogMCwKICAgICAgICAgIGNvbG9yOiBzY2hlZHVsZS5iZ0NvbG9yLAogICAgICAgICAgZV9sb2NrOiBzY2hlZHVsZS5pc1JlYWRPbmx5ID8gMSA6IDAsCiAgICAgICAgfSksCiAgICAgIH07CgogICAgICBheGlvcyhjb25maWcpLnRoZW4oZnVuY3Rpb24gKCkgewogICAgICAgIGVtLkNzY2hlZHVsZUxpc3QgPSBlbS5Dc2NoZWR1bGVMaXN0Lm1hcCgoZWxlbWVudCkgPT4KICAgICAgICAgIGVsZW1lbnQuaWQgIT09IGUuc2NoZWR1bGUuaWQKICAgICAgICAgICAgPyBlbGVtZW50CiAgICAgICAgICAgIDogewogICAgICAgICAgICAgICAgLi4uZWxlbWVudCwKICAgICAgICAgICAgICAgIC4uLnNjaGVkdWxlLAogICAgICAgICAgICAgIH0KICAgICAgICApOwoKICAgICAgICBlbS4kcmVmcy50dWlDYWxlbmRhci5pbnZva2UoInVwZGF0ZVNjaGVkdWxlIiwgZS5zY2hlZHVsZS5pZCwgc2NoZWR1bGUpOwogICAgICB9KTsKICAgIH0sCgogICAgb25CZWZvcmVEZWxldGVTY2hlZHVsZShlKSB7CiAgICAgIHRoaXMuc2VsZWN0ZWQgPSBudWxsOwoKICAgICAgdmFyIGlkYWN0aW9uID0gdGhpcy5Dc2NoZWR1bGVMaXN0LmZpbmQoKGVsZW1lbnQpID0+IHsKICAgICAgICByZXR1cm4gZWxlbWVudC5pZCA9PT0gZS5zY2hlZHVsZS5pZDsKICAgICAgfSk/LmlkYWN0aW9uOwoKICAgICAgdmFyIGNvbmZpZyA9IHsKICAgICAgICBtZXRob2Q6ICJkZWxldGUiLAogICAgICAgIHVybDogdGhpcy5VUklfQUNUSU9OICsgdGhpcy5BUElfS0VZICsgIi8iICsgaWRhY3Rpb24sCiAgICAgICAgaGVhZGVyczoge30sCiAgICAgIH07CgogICAgICBheGlvcyhjb25maWcpLnRoZW4oKCkgPT4gewogICAgICAgIC8vIHJlbW92ZSBpbiBzY2hlZHVsZUxpc3QKICAgICAgICB0aGlzLkNzY2hlZHVsZUxpc3QgPSB0aGlzLkNzY2hlZHVsZUxpc3QuZmlsdGVyKAogICAgICAgICAgKGVsZW1lbnQpID0+IGVsZW1lbnQuaWQgIT09IGUuc2NoZWR1bGUuaWQKICAgICAgICApOwogICAgICAgIHRoaXMuJHJlZnMudHVpQ2FsZW5kYXIuaW52b2tlKAogICAgICAgICAgImRlbGV0ZVNjaGVkdWxlIiwKICAgICAgICAgIGUuc2NoZWR1bGUuaWQsCiAgICAgICAgICBlLnNjaGVkdWxlLmNhbGVuZGFySWQKICAgICAgICApOwogICAgICB9KTsKICAgIH0sCiAgICAvL1N1cHByZXNzaW9uIGRlcyB0YWNoZXMKICAgIG9uQ2xpY2tUaW1lem9uZXNDb2xsYXBzZUJ0bih0aW1lem9uZXNDb2xsYXBzZWQpIHsKICAgICAgLy8gdmlldyA6IHdlZWssIGRheQogICAgICBpZiAodGltZXpvbmVzQ29sbGFwc2VkKSB7CiAgICAgICAgdGhpcy50aGVtZVsid2Vlay50aW1lZ3JpZExlZnQud2lkdGgiXSA9ICIxMDBweCI7CiAgICAgICAgdGhpcy50aGVtZVsid2Vlay5kYXlncmlkTGVmdC53aWR0aCJdID0gIjEwMHB4IjsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnRoZW1lWyJ3ZWVrLnRpbWVncmlkTGVmdC53aWR0aCJdID0gIjUwcHgiOwogICAgICAgIHRoaXMudGhlbWVbIndlZWsuZGF5Z3JpZExlZnQud2lkdGgiXSA9ICI1MHB4IjsKICAgICAgfQogICAgfSwKICAgIGdldENhbGVuZGFyKGNhbGVuZGFySWQpIHsKICAgICAgcmV0dXJuIHRoaXMuY2FsZW5kYXJMaXN0LmZpbmQoKGNhbGVuZGFyKSA9PiBjYWxlbmRhci5pZCA9PT0gY2FsZW5kYXJJZCk7CiAgICB9LAogICAgb3BlbklmcmFtZUVkaXRvcigpIHsKICAgICAgLy8gY3JlYXRlIGRpdiBjYXJkIGJ5IGdldGVsZW1lbnRieWlkCiAgICAgIGxldCBjYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZsb2F0aW5nLWxheWVyLWNvbnRhaW5lciIpOwoKICAgICAgLy8gc2V0IDIvMyB3aWR0aCBvZiBzY3JlZW4gdG8gY2FyZCBvbmx5IG9uIGRlc2t0b3AKICAgICAgaWYgKGNhcmQgIT0gbnVsbCkgewogICAgICAgIGlmICh3aW5kb3cuaW5uZXJXaWR0aCA+IDc2OCkgewogICAgICAgICAgY2FyZC5zdHlsZS53aWR0aCA9ICJjYWxjKDEwMCUgLSAyNTBweCkiOwogICAgICAgICAgY2FyZC5zdHlsZS5oZWlnaHQgPSAiY2FsYygxMDAlIC0gMjUwcHgpIjsKICAgICAgICAgIGNhcmQuc3R5bGUubGVmdCA9ICJjYWxjKDUwJSAtIChjYWxjKDEwMCUgLSAyNTBweCkgLyAyKSkiOwogICAgICAgICAgY2FyZC5zdHlsZS50b3AgPSAiY2FsYyg1MCUgLSAoY2FsYygxMDAlIC0gMjUwcHgpIC8gMikpIjsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2FyZC5zdHlsZS53aWR0aCA9ICJjYWxjKDEwMCUgLSAxNTBweCkiOwogICAgICAgICAgY2FyZC5zdHlsZS5sZWZ0ID0gImNhbGMoNTAlIC0gKGNhbGMoMTAwJSAtIDE1MHB4KSAvIDIpKSI7CiAgICAgICAgICBjYXJkLnN0eWxlLnRvcCA9ICJjYWxjKDUwJSAtIChjYWxjKDEwMCUgLSA4MDBweCkgLyAyKSkiOwogICAgICAgICAgY2FyZC5zdHlsZS5oZWlnaHQgPSAiY2FsYygxMDAlIC0gMTUwcHgpIjsKICAgICAgICB9CgogICAgICB9CiAgICB9LAogICAgY2hlY2tpbmdGcmFtZShlKSB7CiAgICAgIGNvbnNvbGUubG9nKCJtZXNzYWdlIik7CiAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICBjb25zb2xlLmxvZyh0aGlzLiRyZWZzLmVkaXRkYXRhKTsKICAgIH0sCiAgICBlZGl0KCkgewogICAgICB0aGlzLmVkaXRpbmcgPSB0cnVlOwogICAgICB0aGlzLm9wZW5JZnJhbWVFZGl0b3IoKTsKICAgIH0sCiAgICBpZnJhbWVMb2FkZWQoKSB7CiAgICAgIC8vIGdldCBpZnJhbWUgZG9jdW1lbnQKICAgICAgbGV0IGlmcmFtZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJ0dWktZnVsbC1jYWxlbmRhci1wb3B1cC1pZnJhbWUiKTsKCiAgICAgIC8vIGNoZWNrIHVybAogICAgICBpZiAoCiAgICAgICAgaWZyYW1lICYmCiAgICAgICAgaWZyYW1lLmNvbnRlbnRXaW5kb3cubG9jYXRpb24uaHJlZi5pbmNsdWRlcygiL2FjdGlvbi5waHAiKQogICAgICApIHsKICAgICAgICB0aGlzLmVkaXRpbmcgPSBmYWxzZTsKICAgICAgICB0aGlzLmNyZWF0aW5nID0gZmFsc2U7CiAgICAgICAgdGhpcy5zZWxlY3RlZCA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgfSwKICB3YXRjaDogewogICAgdmlldyh2YWx1ZSkgewogICAgICB0aGlzLmNoYW5nZVZpZXcodmFsdWUpOwogICAgICB0aGlzLnNldFJlbmRlclJhbmdlVGV4dCgpOwogICAgfSwKICAgIHNlbGVjdGVkKGNvbnRlbnQpIHsKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgdGhpcy5lZGl0aW5nID0gZmFsc2U7CiAgICAgICAgbGV0IGV2ZW50ID0gbnVsbDsKICAgICAgICBpZiAoY29udGVudCAmJiBjb250ZW50LmV2ZW50KSB7CiAgICAgICAgICBldmVudCA9IGNvbnRlbnQuZXZlbnQ7CiAgICAgICAgICAvLyBnZXQgcG9zaXRpb24gZnJvbSBldmVudAogICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB7CiAgICAgICAgICAgIHRvcDogZXZlbnQucGFnZVkgLSBldmVudC50YXJnZXQub2Zmc2V0VG9wLAogICAgICAgICAgICBsZWZ0OiBldmVudC5wYWdlWCAtIGV2ZW50LnRhcmdldC5vZmZzZXRMZWZ0LAogICAgICAgICAgfTsKCiAgICAgICAgICAvLyBnZXQgZGl2IGNhcmQgYnkgZ2V0ZWxlbWVudGJ5aWQKICAgICAgICAgIGxldCBjYXJkID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZsb2F0aW5nLWxheWVyLWNvbnRhaW5lciIpOwoKICAgICAgICAgIC8vIHNldCBwb3NpdGlvbiBmcm9tIGV2ZW50IG1vdXNlIHRvIGNhcmQKICAgICAgICAgIGlmIChjYXJkKSB7CiAgICAgICAgICAgIGNhcmQuc3R5bGUudG9wID0gYGNhbGMoJHtwb3NpdGlvbi50b3B9cHggLSA4MHB4KWA7CiAgICAgICAgICAgIGNhcmQuc3R5bGUubGVmdCA9IGBjYWxjKCR7cG9zaXRpb24ubGVmdH1weCArIDI1cHgpYDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIDEwMCk7CiAgICB9LAogIH0sCiAgYXN5bmMgbW91bnRlZCgpIHsKICAgIHRoaXMuZ2V0VGVtcGxhdGUoKTsKICAgIGF3YWl0IHRoaXMubG9hZFVzZXJzKCk7IC8vIGxvYWRpbmcgdXNlcnMgbGlzdCoKICAgIHRoaXMuc2V0UmVuZGVyUmFuZ2VUZXh0KCk7CiAgICB0aGlzLmRpc3BhdGNoQWN0aW9uKCk7IC8vIExvYWQgYW5kIHNldCBjYWxlbmRhdCBpdGVtOwoKICAgIC8vIGNsaWNrIG91dHNsaWRlIHRvIGNsb3NlIGNhcmQKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoImNsaWNrIiwgKGUpID0+IHsKICAgICAgLy8gaWYgY2xpY2sgb3V0c2xpZGUKICAgICAgaWYgKAogICAgICAgIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgiY2FsZW5kYXIiKS5jb250YWlucyhlLnRhcmdldCkgPT09IGZhbHNlICYmCiAgICAgICAgICAhdGhpcy5lZGl0aW5nKSB8fAogICAgICAgIChlLnRhcmdldC5jbGFzc05hbWUgIT09ICJ0dWktZnVsbC1jYWxlbmRhci13ZWVrZGF5LXNjaGVkdWxlIiAmJgogICAgICAgICAgZS50YXJnZXQuY2xhc3NOYW1lICE9PSAidHVpLWZ1bGwtY2FsZW5kYXItd2Vla2RheS1zY2hlZHVsZS10aXRsZSIgJiYKICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTmFtZS5pbmNsdWRlcygidHVpLWZ1bGwtY2FsZW5kYXItd2Vla2RheS1ncmlkLWxpbmUiKSAmJgogICAgICAgICAgZS50YXJnZXQuY2xhc3NOYW1lID09PQogICAgICAgICAgICAidHVpLWZ1bGwtY2FsZW5kYXItd2Vla2RheS1zY2hlZHVsZS1jb250ZW50IikgfHwKICAgICAgICBlLnRhcmdldC5jbGFzc05hbWUuaW5jbHVkZXMoCiAgICAgICAgICAidHVpLWZ1bGwtY2FsZW5kYXItdGltZS1kYXRlLXNjaGVkdWxlLWJsb2NrLXdyYXAiCiAgICAgICAgKSB8fAogICAgICAgICgoZS50YXJnZXQuY2xhc3NOYW1lLmluY2x1ZGVzKCJ0dWktZnVsbC1jYWxlbmRhci13ZWVrZGF5LXNjaGVkdWxlIikgfHwKICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTmFtZS5pbmNsdWRlcygKICAgICAgICAgICAgInR1aS1mdWxsLWNhbGVuZGFyLXdlZWtkYXktc2NoZWR1bGUtY29udGVudCIKICAgICAgICAgICkgfHwKICAgICAgICAgIGUudGFyZ2V0LmNsYXNzTmFtZS5pbmNsdWRlcygidHVpLWZ1bGwtY2FsZW5kYXItd2Vla2RheS1ncmlkLWxpbmUiKSB8fAogICAgICAgICAgZS50YXJnZXQuY2xhc3NOYW1lLmluY2x1ZGVzKAogICAgICAgICAgICAidHVpLWZ1bGwtY2FsZW5kYXItdGltZS1kYXRlLXNjaGVkdWxlLWJsb2NrLXdyYXAiCiAgICAgICAgICApKSAmJgogICAgICAgICAgdGhpcy5lZGl0aW5nKSB8fAogICAgICAgICgoZS50YXJnZXQuY2xhc3NOYW1lLmluY2x1ZGVzKCJ0dWktZnVsbC1jYWxlbmRhci13ZWVrZGF5LWdyaWQtbGluZSIpIHx8CiAgICAgICAgICBlLnRhcmdldC5jbGFzc05hbWUuaW5jbHVkZXMoCiAgICAgICAgICAgICJ0dWktZnVsbC1jYWxlbmRhci10aW1lLWRhdGUtc2NoZWR1bGUtYmxvY2std3JhcCIKICAgICAgICAgICkpICYmCiAgICAgICAgICB0aGlzLmVkaXRpbmcgJiYKICAgICAgICAgIHRoaXMuY3JlYXRpbmcpCiAgICAgICkgewogICAgICAgIHRoaXMuZWRpdGluZyA9IGZhbHNlOwogICAgICAgIHRoaXMuY3JlYXRpbmcgPSBmYWxzZTsKICAgICAgICB0aGlzLnNlbGVjdGVkID0gbnVsbDsKICAgICAgICBpZiAodGhpcy5jbGlja0NvdW50ID09PSAxKSB0aGlzLmNsaWNrQ291bnQgPT09IDI7CiAgICAgICAgaWYgKHRoaXMuY2xpY2tDb3VudCA9PT0gMikgdGhpcy5jbGlja0NvdW50ID09PSAwOwogICAgICB9IGVsc2UgaWYgKAogICAgICAgIHRoaXMuc2VsZWN0ZWQgIT09IG51bGwgJiYKICAgICAgICBlLnRhcmdldC5jbGFzc05hbWUgIT09ICJ0dWktZnVsbC1jYWxlbmRhci13ZWVrZGF5LXNjaGVkdWxlLXRpdGxlIiAmJgogICAgICAgIGUudGFyZ2V0LmNsYXNzTmFtZSAhPT0KICAgICAgICAgICJ0dWktZnVsbC1jYWxlbmRhci10aW1lLXNjaGVkdWxlLWNvbnRlbnQgdHVpLWZ1bGwtY2FsZW5kYXItdGltZS1zY2hlZHVsZS1jb250ZW50LXRpbWUiICYmCiAgICAgICAgIXRoaXMuZWRpdGluZwogICAgICApIHsKICAgICAgICB0aGlzLnNlbGVjdGVkID0gbnVsbDsKICAgICAgICBpZiAodGhpcy5jbGlja0NvdW50ID09PSAxKSB0aGlzLmNsaWNrQ291bnQgPT09IDI7CiAgICAgICAgaWYgKHRoaXMuY2xpY2tDb3VudCA9PT0gMikgdGhpcy5jbGlja0NvdW50ID09PSAwOwogICAgICB9IGVsc2UgaWYgKAogICAgICAgIGUudGFyZ2V0LmNsYXNzTmFtZSA9PT0gInR1aS1mdWxsLWNhbGVuZGFyLXdlZWtkYXktc2NoZWR1bGUtdGl0bGUiIHx8CiAgICAgICAgZS50YXJnZXQuY2xhc3NOYW1lID09PQogICAgICAgICAgInR1aS1mdWxsLWNhbGVuZGFyLXRpbWUtc2NoZWR1bGUtY29udGVudCB0dWktZnVsbC1jYWxlbmRhci10aW1lLXNjaGVkdWxlLWNvbnRlbnQtdGltZSIKICAgICAgKSB7CiAgICAgICAgdGhpcy5jcmVhdGluZyA9IGZhbHNlOwogICAgICAgIGlmICh0aGlzLmNsaWNrQ291bnQgPT09IDEpIHRoaXMuY2xpY2tDb3VudCA9PT0gMjsKICAgICAgICBpZiAodGhpcy5jbGlja0NvdW50ID09PSAyKSB0aGlzLmNsaWNrQ291bnQgPT09IDA7CiAgICAgIH0KICAgIH0pOwogIH0sCn07Cg=="},{"version":3,"sources":["agenda.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8WA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"agenda.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"columns is-multiline is-mobile\">\n    <b-loading\n      :is-full-page=\"isFullPage\"\n      v-model=\"isLoading\"\n      :can-cancel=\"true\"\n    ></b-loading>\n    <div class=\"column is-12\">\n      <div\n        class=\"is-flex-widescreen is-flex-wrap-wrap is-justify-content-space-between is-align-items-center px-6 py-2 has-text-left\"\n      >\n        <div class=\"is-flex-widescreen is-align-items-center\">\n          <div\n            class=\"is-flex-tablet is-flex-wrap-wrap is-align-items-center mr-2 mb-2\"\n          >\n            <label class=\"label pt-2\">\n              Affichage <span class=\"is-hidden-widescreen\">&nbsp;&nbsp;</span> :\n              &nbsp;\n            </label>\n            <div class=\"control is-flex-grow-2\">\n              <div\n                class=\"dropdown is-block is-fullwidth\"\n                v-bind:class=\"showing\"\n              >\n                <div class=\"dropdown-trigger\">\n                  <button\n                    class=\"button is-fullwidth is-justify-content-space-between\"\n                    aria-haspopup=\"true\"\n                    aria-controls=\"dropdown-menu\"\n                    @click=\"show\"\n                  >\n                    <span class=\"icon-text\">\n                      <span class=\"icon\">\n                        <i\n                          class=\"fas fa-circle\"\n                          v-bind:style=\"{ color: typeview.color }\"\n                        ></i>\n                      </span>\n                      <span>{{ typeview.title }}</span>\n                    </span>\n                    <span class=\"icon is-small\">\n                      <i class=\"fas fa-angle-down\" aria-hidden=\"true\"></i>\n                    </span>\n                  </button>\n                </div>\n                <div class=\"dropdown-menu\" id=\"dropdown-menu\" role=\"menu\">\n                  <div class=\"dropdown-content\">\n                    <a\n                      class=\"dropdown-item\"\n                      v-for=\"(item, i) in arrayFilter\"\n                      :key=\"i\"\n                      :value=\"item.title\"\n                      @click=\"setView(item)\"\n                    >\n                      <span class=\"icon-text\">\n                        <span class=\"icon\" v-bind:style=\"{ color: item.color }\">\n                          <i class=\"fas fa-circle\"></i>\n                        </span>\n                        <span>{{ item.title }}</span>\n                      </span>\n                    </a>\n                    <hr class=\"dropdown-divider\" />\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"is-flex-tablet is-flex-wrap-wrap is-align-items-center mr-2 mb-2\"\n          >\n            <label class=\"label pt-2\">Utilisateurs : &nbsp;</label>\n            <div class=\"control is-flex-grow-2\">\n              <div class=\"select is-block\">\n                <multiselect\n                  v-model=\"selectedUsers\"\n                  :options=\"users\"\n                  :multiple=\"true\"\n                  :close-on-select=\"false\"\n                  :clear-on-select=\"false\"\n                  :preserve-search=\"true\"\n                  placeholder=\"Selectionnez\"\n                  label=\"name\"\n                  track-by=\"name\"\n                  :preselect-first=\"true\"\n                  @close=\"dispatchAction\"\n                >\n                  <template\n                    slot=\"selection\"\n                    slot-scope=\"{ values, search, isOpen }\"\n                    ><span\n                      class=\"multiselect__single\"\n                      v-if=\"values.length &amp;&amp; !isOpen\"\n                      >{{ values.length }} selections</span\n                    ></template\n                  >\n                </multiselect>\n              </div>\n            </div>\n          </div>\n          <div\n            class=\"is-flex-tablet is-align-items-center is-justify-content-end mb-2 mr-2\"\n          >\n            <div class=\"control is-flex is-flex-grow-2\">\n              <span\n                class=\"is-hidden-mobile is-block-tablet-only is-hidden-widescreen\"\n              >\n                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n                &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\n              </span>\n              <div class=\"select is-flex-grow-2 is-flex\">\n                <select v-model=\"view\" class=\"is-flex-grow-2\">\n                  <option\n                    v-for=\"(option, index) in viewModeOptions\"\n                    :value=\"option.value\"\n                    :key=\"index\"\n                  >\n                    {{ option.title }}\n                  </option>\n                </select>\n              </div>\n            </div>\n          </div>\n          <label\n            for=\"history\"\n            class=\"label is-flex-tablet is-flex-wrap-wrap is-align-items-center mr-2 mb-2\"\n          >\n            Historique<span class=\"is-hidden-widescreen\"\n              >&nbsp;&nbsp;&nbsp;</span\n            >\n            : &nbsp;\n            <input\n              type=\"checkbox\"\n              id=\"history\"\n              v-model=\"history\"\n              @click=\"dispatchAction\"\n            />\n          </label>\n        </div>\n        <div\n          class=\"is-flex is-flex-wrap-wrap is-justify-content-center is-align-items-center\"\n        >\n          <div class=\"mr-2 mb-2 text-center\">\n            <strong class=\"is-size-5\">{{ renderRange }}</strong>\n          </div>\n          <div class=\"is-flex is-flex-grow-2 is-align-items-center\">\n            <div class=\"mr-2 mb-2\">\n              <button\n                type=\"button\"\n                class=\"button is-flex is-align-items-center is-outlined flat-button\"\n                data-action=\"move-prev\"\n                @click=\"prev()\"\n              >\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"20\"\n                  height=\"20\"\n                  viewBox=\"0 0 20 20\"\n                  fill=\"currentColor\"\n                >\n                  <path\n                    fill-rule=\"evenodd\"\n                    d=\"M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z\"\n                    clip-rule=\"evenodd\"\n                  />\n                </svg>\n              </button>\n            </div>\n            <div class=\"mr-2 mb-2 is-flex-grow-2\">\n              <button\n                type=\"button\"\n                class=\"button is-block is-fullwidth is-outlined flat-button\"\n                data-action=\"move-today\"\n                @click=\"today()\"\n              >\n                Aujourd'hui\n              </button>\n            </div>\n            <div class=\"mr-2 my-2\">\n              <button\n                type=\"button\"\n                class=\"button is-flex is-align-items-center is-outlined flat-button\"\n                data-action=\"move-next\"\n                @click=\"next()\"\n              >\n                <svg\n                  xmlns=\"http://www.w3.org/2000/svg\"\n                  width=\"20\"\n                  height=\"20\"\n                  viewBox=\"0 0 20 20\"\n                  fill=\"currentColor\"\n                >\n                  <path\n                    fill-rule=\"evenodd\"\n                    d=\"M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z\"\n                    clip-rule=\"evenodd\"\n                  />\n                </svg>\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class=\"column is-12\" id=\"calendar\">\n      <Calendar\n        ref=\"tuiCalendar\"\n        style=\"height: 800px; width: 100%\"\n        :view=\"view\"\n        :calendars=\"calendarList\"\n        v-bind:schedules=\"CscheduleList\"\n        :taskView=\"taskView\"\n        :scheduleView=\"scheduleView\"\n        :theme=\"theme\"\n        :week=\"week\"\n        :month=\"month\"\n        :useCreationPopup=\"useCreationPopup\"\n        :useDetailPopup=\"useDetailPopup\"\n        :timezones=\"timezones\"\n        :disableDblClick=\"disableDblClick\"\n        :isReadOnly=\"isReadOnly\"\n        :template=\"template\"\n        @beforeCreateSchedule=\"onBeforeCreateSchedule\"\n        @beforeDeleteSchedule=\"onBeforeDeleteSchedule\"\n        @beforeUpdateSchedule=\"onBeforeUpdateSchedule\"\n        @clickDayname=\"onClickDayname\"\n        @clickSchedule=\"onClickSchedule\"\n        @clickTimezonesCollapseBtn=\"onClickTimezonesCollapseBtn\"\n      />\n      <div\n        class=\"tui-full-calendar-floating-layer\"\n        id=\"floating-layer-container\"\n        style=\"display: block; position: absolute; z-index: 1000\"\n        v-if=\"selected || creating\"\n      >\n        <div\n          class=\"tui-full-calendar-popup tui-full-calendar-popup-detail\"\n          v-if=\"!editing\"\n        >\n          <div\n            class=\"tui-full-calendar-popup-container\"\n            v-if=\"selected && !editing\"\n          >\n            <div\n              class=\"tui-full-calendar-popup-section tui-full-calendar-section-header\"\n            >\n              <div>\n                <span\n                  class=\"tui-full-calendar-schedule-private tui-full-calendar-icon tui-full-calendar-ic-private\"\n                ></span>\n                <span class=\"tui-full-calendar-schedule-title\">{{\n                  selected.schedule.title\n                }}</span>\n              </div>\n              <div\n                class=\"tui-full-calendar-popup-detail-date tui-full-calendar-content\"\n              >\n                {{\n                  getTemplate().popupDetailDate(\n                    selected.schedule.isAllDay,\n                    selected.schedule.start,\n                    selected.schedule.end\n                  )\n                }}\n              </div>\n            </div>\n            <div class=\"tui-full-calendar-section-detail\">\n              <div\n                class=\"tui-full-calendar-popup-detail-item\"\n                v-if=\"selected.schedule.location\"\n              >\n                <span\n                  class=\"tui-full-calendar-icon tui-full-calendar-ic-location-b\"\n                ></span\n                ><span class=\"tui-full-calendar-content\">{{\n                  getTemplate().popupDetailLocation(selected.schedule)\n                }}</span>\n              </div>\n\n              <div class=\"tui-full-calendar-popup-detail-item\">\n                <span\n                  class=\"tui-full-calendar-icon tui-full-calendar-ic-state-b\"\n                ></span\n                ><span class=\"tui-full-calendar-content\">\n                  {{ getTemplate().popupDetailState(selected.schedule) }}</span\n                >\n              </div>\n              <div class=\"tui-full-calendar-popup-detail-item\">\n                <span\n                  class=\"tui-full-calendar-icon tui-full-calendar-calendar-dot\"\n                  :style=\"{\n                    backgroundColor: getCalendar(selected.schedule.calendarId)\n                      .bgColor,\n                  }\"\n                ></span\n                ><span class=\"tui-full-calendar-content\">{{\n                  getCalendar(selected.schedule.calendarId).name\n                }}</span>\n              </div>\n            </div>\n            <div\n              class=\"tui-full-calendar-section-button\"\n              v-if=\"!selected.schedule.isReadOnly\"\n            >\n              <button class=\"tui-full-calendar-popup-edit\" @click=\"edit()\">\n                <span\n                  class=\"tui-full-calendar-icon tui-full-calendar-ic-edit\"\n                ></span\n                ><span class=\"tui-full-calendar-content\">Modifier</span>\n              </button>\n              <div class=\"tui-full-calendar-popup-vertical-line\"></div>\n              <button\n                class=\"tui-full-calendar-popup-delete\"\n                @click=\"onBeforeDeleteSchedule(selected)\"\n              >\n                <span\n                  class=\"tui-full-calendar-icon tui-full-calendar-ic-delete\"\n                ></span\n                ><span class=\"tui-full-calendar-content\">Supprimer</span>\n              </button>\n            </div>\n          </div>\n          <div\n            class=\"tui-full-calendar-popup-top-line\"\n            :style=\"{\n              backgroundColor: getCalendar(selected.schedule.calendarId)\n                .bgColor,\n            }\"\n            v-if=\"selected && !editing\"\n          ></div>\n          <div\n            id=\"tui-full-calendar-popup-arrow\"\n            class=\"tui-full-calendar-popup-arrow tui-full-calendar-arrow-left\"\n            v-if=\"selected && !editing\"\n          >\n            <div class=\"tui-full-calendar-popup-arrow-border\">\n              <div class=\"tui-full-calendar-popup-arrow-fill\"></div>\n            </div>\n          </div>\n        </div>\n\n        <iframe\n          title=\"iframe\"\n          ref=\"editdata\"\n          id=\"tui-full-calendar-popup-iframe\"\n          :src=\"\n            creating\n              ? URI_ACTION_CREATION + '?date_debut=' + dateCreateEvent\n              : URI_ACTION_UPDATE + selected.schedule.id\n          \"\n          width=\"100%\"\n          height=\"100%\"\n          seamless=true\n          display=\"block\"\n          v-if=\"editing || creating\"\n          v-on:message=\"checkingFrame\"\n          v-on:click=\"checkingFrame\"\n          v-on:mouseup=\"checkingFrame\"\n          v-on:change=\"checkingFrame\"\n          v-on:load=\"checkingFrame\"\n\n        ></iframe>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { Calendar } from \"@toast-ui/vue-calendar\"; /* ES6 */\nimport \"tui-calendar/dist/tui-calendar.css\";\n// If you use the default popups, use this.\nimport \"tui-date-picker/dist/tui-date-picker.css\";\nimport \"tui-time-picker/dist/tui-time-picker.css\";\n\nimport axios from \"axios\";\n\nimport moment from \"moment\";\n\nimport myTheme from \"./myTheme\";\nimport Multiselect from \"vue-multiselect\";\nimport \"vue-multiselect/dist/vue-multiselect.min.css\";\n// eslint-disable-next-line no-unused-vars\nconst getDate = (type, start, value, operator) => {\n  start = new Date(start);\n  type = type.charAt(0).toUpperCase() + type.slice(1);\n  if (operator === \"+\") {\n    start[`set${type}`](start[`get${type}`]() + value);\n  } else {\n    start[`set${type}`](start[`get${type}`]() - value);\n  }\n  return start;\n};\nexport default {\n  components: { Calendar, Multiselect },\n  props: {\n    API_KEY: {\n      type: String,\n      default() {\n        return \"\";\n      },\n    },\n\n    URI: {\n      type: String,\n      default() {\n        return \"https://0002-zebridge-dev-externe.api.crm-simple.com/interactions/\";\n      },\n    },\n\n    URI_HISTORY: {\n      type: String,\n      default() {\n        return \"https://0002-zebridge-dev-externe.api.crm-simple.com/interactionshistorique/\";\n      },\n    },\n\n    URI_ACTION: {\n      type: String,\n      default() {\n        return \"https://0002-zebridge-dev-externe.api.crm-simple.com/interaction/\";\n      },\n    },\n\n    URI_ACTION_CREATION: {\n      type: String,\n      default() {\n        return \"https://0002-zebridge-dev-externe.crm-simple.com/action_edit.php\";\n      },\n    },\n\n    URI_ACTION_UPDATE: {\n      type: String,\n      default() {\n        return \"https://0002-zebridge-dev-externe.crm-simple.com/action_edit.php?idaction=\";\n      },\n    },\n\n    locale: {\n      type: String,\n      default() {\n        return \"fr-FR\";\n      },\n    },\n\n    calendarList: {\n      type: Array,\n      default() {\n        return [\n          {\n            id: \"0\",\n            name: \"Private\",\n            bgColor: \"#9e5fff\",\n            borderColor: \"#9e5fff\",\n          },\n          {\n            id: \"1\",\n            name: \"Company\",\n            bgColor: \"#00a9ff\",\n            borderColor: \"#00a9ff\",\n          },\n        ];\n      },\n    },\n    USER_API: {\n      type: String,\n      default() {\n        return \"https://0002-zebridge-dev-externe.api.crm-simple.com/utilisateurs/\";\n      },\n    },\n    arrayFilter: {\n      type: Array,\n      default() {\n        return [\n          {\n            color: \"#2251ff\",\n            title: \"Défaut\",\n            index: \"color_defaut\",\n          },\n          {\n            color: \"#ffcedf0\",\n            title: \"Etat\",\n            index: \"color_etat\",\n          },\n          {\n            color: \"#25ffcd\",\n            title: \"Priorité\",\n            index: \"color_priorite\",\n          },\n          {\n            color: \"#de452a\",\n            title: \"Utilisateur\",\n            index: \"color_utilisateur\",\n          },\n          {\n            color: \"#cdee00\",\n            title: \"Type\",\n            index: \"color_type\",\n          },\n          {\n            color: \"#e19400\",\n            title: \"Priorité échéance\",\n            index: \"color_priorite_echeance\",\n          },\n        ];\n      },\n    },\n    idUtilisateurs: {\n      type: Array,\n      default() {\n        return [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\"];\n      },\n    },\n    idprojets: {\n      type: Array,\n      default() {\n        return [];\n      },\n    },\n    idcontacts: {\n      type: Array,\n      default() {\n        return [];\n      },\n    },\n    idsocietes: {\n      type: Array,\n      default() {\n        return [];\n      },\n    },\n    scheduleList: {\n      type: Array,\n      default() {\n        return [];\n      },\n    },\n    viewModeOptions: {\n      type: Array,\n      default() {\n        return [\n          {\n            title: \"Mois\",\n            value: \"month\",\n          },\n          {\n            title: \"Semaine\",\n            value: \"week\",\n          },\n          {\n            title: \"Jour\",\n            value: \"day\",\n          },\n        ];\n      },\n    },\n\n    dateRange: {\n      type: Array,\n      default() {\n        return [moment().subtract(1, \"month\").toDate(), moment().toDate()];\n      },\n    },\n\n    timezones: {\n      type: Array,\n      default() {\n        return [\n          // paris\n          {\n            name: \"Europe/Paris\",\n            label: \"Paris\",\n            offset: \"+01:00\",\n          },\n        ];\n      },\n    },\n\n    month: {\n      type: Object,\n      default() {\n        return {\n          startDayOfWeek: 1,\n          daynames: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"],\n        };\n      },\n    },\n\n    week: {\n      type: Object,\n      default() {\n        return {\n          showTimezoneCollapseButton: true,\n          timezonesCollapsed: true,\n          daynames: [\"Dim\", \"Lun\", \"Mar\", \"Mer\", \"Jeu\", \"Ven\", \"Sam\"],\n          startDayOfWeek: 1,\n        };\n      },\n    },\n\n    taskView: {\n      type: Boolean,\n      default() {\n        return true;\n      },\n    },\n\n    scheduleView: {\n      type: Array,\n      default() {\n        return [\"time\"];\n      },\n    },\n\n    disableDblClick: {\n      type: Boolean,\n      default() {\n        return true;\n      },\n    },\n\n    isReadOnly: {\n      type: Boolean,\n      default() {\n        return false;\n      },\n    },\n\n    // view: {\n    //   type: String,\n    //   default() {\n    //     return \"month\";\n    //   },\n    // },\n    useCreationPopup: {\n      type: Boolean,\n      default() {\n        return false;\n      },\n    },\n    useDetailPopup: {\n      type: Boolean,\n      default() {\n        return false;\n      },\n    },\n  },\n  data() {\n    return {\n      users: [],\n      selectedUsers: [],\n      editing: false,\n      history: false,\n      creating: false,\n      clickCount: 0,\n      selected: null,\n      isFullPage: false,\n      isLoading: true,\n      info: null,\n      event: null,\n      view: \"month\",\n      isComponentModalActive: false,\n      renderRange: null,\n      startDate: \"\",\n      endDate: \"\",\n      dateCreateEvent: \"\",\n      form: {\n        sujet: \"\",\n        color: \"\",\n        date_debut: \"\",\n        date_fin: \"\",\n\n        submit: false,\n      },\n      errors: {\n        sujet: \"Le champs titre est obligatoire\",\n        date_debut: \"Le date debut est obligatoire\",\n        date_fin: \"Le date fin est obligatoire\",\n        color: \"Le champs couleur est obligatoire\",\n      },\n      template: this.getTemplate(),\n      theme: myTheme,\n      CscheduleList: [],\n      showing: \"\",\n      typeview: {\n        title: \"Selectionnez\",\n        color: \"#2251ff\",\n        index: \"color_defaut\",\n      },\n    };\n  },\n\n  methods: {\n    show() {\n      this.showing = this.showing.length === 0 ? \"is-active\" : \"\";\n    },\n\n    setView(type) {\n      this.typeview = type;\n      this.show(); // show or hide the dropdown\n\n      this.dispatchAction();\n    },\n    isUserSelected(idUser) {\n      return this.idUtilisateurs.find(idUser) > 0;\n    },\n    async loadUsers() {\n      await axios({\n        method: \"get\",\n        url: this.USER_API + this.API_KEY,\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      })\n        .then((response) => {\n          if (response.data.result === 1) {\n            this.users = response.data.data.map((el) => {\n              return {\n                id: el.idutilisateur.value.toString(),\n                name: el.nom_utilisateur.value.toString(),\n              };\n            });\n            this.selectedUsers = this.users.filter(\n              (x) => x.id in this.idUtilisateurs\n            );\n          } else {\n            console.log(response.data.err_message);\n          }\n        })\n        .catch((err) => {\n          console.log(err);\n        });\n    },\n    async dispatchAction() {\n      this.isLoading = true;\n\n      // callinf fisrt route\n      this.CscheduleList = await this.getCalendarItem(0, false).then(\n        (items) => {\n          return items.flat(Infinity);\n        }\n      );\n\n      // 2 route onDueDate is true\n      this.CscheduleList = this.CscheduleList.concat(\n        await this.getCalendarItem(0, true).then((items) => {\n          return items.flat(Infinity);\n        })\n      );\n\n      // calling third route\n      if (this.history) {\n        this.CscheduleList = this.CscheduleList.concat(\n          await this.getIteractionsHistory(0).then((historyItems) => {\n            return historyItems.flat(Infinity);\n          })\n        );\n      }\n      this.isLoading = false;\n    },\n\n    setColor(type, data) {\n      let color = type.color;\n      try {\n        const jsondata = data.color.value;\n        color = JSON.parse(jsondata)[type.index];\n      } catch (error) {\n        console.log(\"undefined color data\");\n      }\n\n      return color;\n    },\n    getTemplate() {\n      const th = this;\n      return {\n        milestone: function (schedule) {\n          return (\n            '<span class=\"calendar-font-icon ic-milestone-b\"></span> <span style=\"background-color: ' +\n            schedule.bgColor +\n            '\">' +\n            schedule.title +\n            \"</span>\"\n          );\n        },\n        milestoneTitle: function () {\n          return '<span class=\"tui-full-calendar-left-content\">ETAPE</span>';\n        },\n        task: function (schedule) {\n          return \"#\" + schedule.title;\n        },\n        taskTitle: function () {\n          return '<span class=\"tui-full-calendar-left-content\">TACHE</span>';\n        },\n        allday: function (schedule) {\n          return th._getTimeTemplate(schedule, true);\n        },\n        alldayTitle: function () {\n          return '<span class=\"tui-full-calendar-left-content\"> Toute la journée</span>';\n        },\n        time: function (schedule) {\n          return th._getTimeTemplate(schedule, false);\n        },\n        goingDuration: function (schedule) {\n          return (\n            '<span class=\"calendar-icon ic-travel-time\"></span>' +\n            schedule.goingDuration +\n            \"min.\"\n          );\n        },\n        comingDuration: function (schedule) {\n          return (\n            '<span class=\"calendar-icon ic-travel-time\"></span>' +\n            schedule.comingDuration +\n            \"min.\"\n          );\n        },\n        monthMoreTitleDate: function (date, dayname) {\n          var day = date.split(\".\")[2];\n\n          return (\n            '<span class=\"tui-full-calendar-month-more-title-day\">' +\n            day +\n            '</span> <span class=\"tui-full-calendar-month-more-title-day-label\">' +\n            dayname +\n            \"</span>\"\n          );\n        },\n        monthMoreClose: function () {\n          return '<span class=\"tui-full-calendar-icon tui-full-calendar-ic-close\"></span>';\n        },\n        monthGridHeader: function (dayModel) {\n          var date = parseInt(dayModel.date.split(\"-\")[2], 10);\n          var classNames = [\"tui-full-calendar-weekday-grid-date \"];\n\n          if (dayModel.isToday) {\n            classNames.push(\"tui-full-calendar-weekday-grid-date-decorator\");\n          }\n\n          return (\n            '<span class=\"' + classNames.join(\" \") + '\">' + date + \"</span>\"\n          );\n        },\n        monthGridHeaderExceed: function (hiddenSchedules) {\n          return (\n            '<span class=\"weekday-grid-more-schedules\">+' +\n            hiddenSchedules +\n            \"</span>\"\n          );\n        },\n        monthGridFooter: function () {\n          return \"\";\n        },\n        monthGridFooterExceed: function () {\n          return \"\";\n        },\n        monthDayname: function (model) {\n          return model.label.toString().toLocaleUpperCase();\n        },\n        weekDayname: function (model) {\n          return (\n            '<span class=\"tui-full-calendar-dayname-date\">' +\n            model.date +\n            '</span>&nbsp;&nbsp;<span class=\"tui-full-calendar-dayname-name\">' +\n            model.dayName +\n            \"</span>\"\n          );\n        },\n        weekGridFooterExceed: function (hiddenSchedules) {\n          return \"+\" + hiddenSchedules;\n        },\n        dayGridTitle: function (viewName) {\n          // use another functions instead of 'dayGridTitle'\n          // milestoneTitle: function() {...}\n          // taskTitle: function() {...}\n          // alldayTitle: function() {...}\n\n          var title = \"\";\n          switch (viewName) {\n            case \"milestone\":\n              title =\n                '<span class=\"tui-full-calendar-left-content\">ETAPE</span>';\n              break;\n            case \"task\":\n              title =\n                '<span class=\"tui-full-calendar-left-content\">TACHE</span>';\n              break;\n            case \"allday\":\n              title =\n                '<span class=\"tui-full-calendar-left-content\">Toute la journée</span>';\n              break;\n            default:\n              break;\n          }\n\n          return title;\n        },\n\n        collapseBtnTitle: function () {\n          return '<span class=\"tui-full-calendar-icon tui-full-calendar-ic-arrow-solid-top\"></span>';\n        },\n\n        timegridDisplayPrimayTime: function (time) {\n          // will be deprecated. use 'timegridDisplayPrimaryTime'\n          return time.hour.toString();\n        },\n        timegridCurrentTime: function (timezone) {\n          var templates = [];\n\n          if (timezone.dateDifference) {\n            templates.push(\n              \"[\" +\n                timezone.dateDifferenceSign +\n                timezone.dateDifference +\n                \"]<br>\"\n            );\n          }\n\n          templates.push(moment(timezone.hourmarker).format(\"HH:mm\"));\n\n          return templates.join(\"\");\n        },\n        popupIsAllDay: function () {\n          return \"Toute la journée\";\n        },\n        popupStateFree: function () {\n          return \"Libre\";\n        },\n        popupStateBusy: function () {\n          return \"Occupé\";\n        },\n        titlePlaceholder: function () {\n          return \"Sujet\";\n        },\n        locationPlaceholder: function () {\n          return \"Lieu\";\n        },\n        startDatePlaceholder: function () {\n          return \"Date de Début\";\n        },\n        endDatePlaceholder: function () {\n          return \"Date de fin\";\n        },\n        popupSave: function () {\n          return \"Valider\";\n        },\n        popupUpdate: function () {\n          return \"Mettre à jour\";\n        },\n        popupDetailDate: function (isAllDay, start, end) {\n          var isSameDate = moment(start).isSame(end);\n          var endFormat = (isSameDate ? \"\" : \"YYYY/MM/DD \") + \"HH:mm\";\n\n          if (isAllDay) {\n            return (\n              moment(start).format(\"YYYY/MM/DD\") +\n              (isSameDate ? \"\" : \" - \" + moment(end).format(\"YYYY/MM/DD\"))\n            );\n          }\n\n          return (\n            moment(start.toDate()).format(\"YYYY/MM/DD HH:mm\") +\n            \" - \" +\n            moment(end.toDate()).format(endFormat)\n          );\n        },\n        popupDetailLocation: function (schedule) {\n          return \"Lieu : \" + schedule.location;\n        },\n        // popupDetailUser: function (schedule) {\n        // \treturn 'Staff : ' + (schedule.attendees || []).join(', ')\n        // },\n        popupDetailState: function (schedule) {\n          return \" Statut: \" + schedule.state === \"Free\" ? \"Libre\" : \"Occupé\";\n        },\n        popupDetailRepeat: function (schedule) {\n          return \"Repeat : \" + schedule.recurrenceRule;\n        },\n        popupDetailBody: function (schedule) {\n          return \"Body : \" + schedule.body;\n        },\n        popupEdit: function () {\n          return \"Modifier\";\n        },\n        popupDelete: function () {\n          return \"Supprimer\";\n        },\n      };\n    },\n    _getTimeTemplate(schedule, isAllDay) {\n      var html = [];\n\n      if (!isAllDay) {\n        html.push(\n          \"<strong>\" +\n            moment(schedule.start.toDate()).format(\"HH:mm\") +\n            \"</strong> \"\n        );\n      }\n      if (schedule.isPrivate) {\n        html.push('<span class=\"calendar-font-icon ic-lock-b\"></span>');\n        html.push(\" Private\");\n      } else {\n        if (schedule.isReadOnly) {\n          html.push('<span class=\"calendar-font-icon ic-readonly-b\"></span>');\n        } else if (schedule.recurrenceRule) {\n          html.push('<span class=\"calendar-font-icon ic-repeat-b\"></span>');\n        } else if (schedule.attendees.length) {\n          html.push('<span class=\"calendar-font-icon ic-user-b\"></span>');\n        } else if (schedule.location) {\n          html.push('<span class=\"calendar-font-icon ic-location-b\"></span>');\n        }\n\n        html.push(\" \" + schedule.title);\n      }\n\n      return html.join(\"\");\n    },\n\n    setRenderRangeText() {\n      let options = this.$refs.tuiCalendar.invoke(\"getOptions\");\n      let viewName = this.$refs.tuiCalendar.invoke(\"getViewName\");\n      let html = [];\n      this.startDate = this.$refs.tuiCalendar\n        .invoke(\"getDateRangeStart\")\n        .toDate()\n        .toLocaleDateString(\"fr-CA\");\n      this.endDate = this.$refs.tuiCalendar\n        .invoke(\"getDateRangeEnd\")\n        .toDate()\n        .toLocaleDateString(\"fr-CA\");\n\n      if (viewName === \"day\") {\n        html.push(this.currentCalendarDate(\"DD MMMM YYYY\"));\n      } else if (\n        viewName === \"month\" &&\n        (!options.month.visibleWeeksCount ||\n          options.month.visibleWeeksCount > 4)\n      ) {\n        html.push(this.currentCalendarDate(\"MMMM YYYY\"));\n      } else {\n        let time = moment(\n          this.$refs.tuiCalendar.invoke(\"getDateRangeStart\").getTime()\n        );\n\n        let currentdate = new Date(time);\n        let oneJan = new Date(currentdate.getFullYear(), 0, 1);\n        let numberOfDays = Math.floor(\n          (currentdate - oneJan) / (24 * 60 * 60 * 1000)\n        );\n        let result = Math.ceil((currentdate.getDay() + 1 + numberOfDays) / 7);\n        html.push(\n          \"Semaine \" +\n            result +\n            \" | \" +\n            moment(this.$refs.tuiCalendar.invoke(\"getDateRangeStart\").getTime())\n              .locale(this.locale)\n              .format(\"DD MMMM YYYY\")\n        );\n        html.push(\" - \");\n        html.push(\n          moment(this.$refs.tuiCalendar.invoke(\"getDateRangeEnd\").getTime())\n            .locale(this.locale)\n            .format(\"DD MMMM YYYY\")\n        );\n      }\n      this.renderRange = html.join(\"\");\n    },\n    generateQueryFor(dataArray, dataParam, result) {\n      if (dataArray.length > 0) {\n        result = result.concat(\n          result.length === 0 ? \"condition:\" : \":separator:AND:condition:\",\n          this.setfilter(dataArray, dataParam)\n        );\n      }\n      return result;\n    },\n    getQueryParam(dateFilter = \"date_action\") {\n      /**\n       *@param none\n       *@author Jacques\n       *@Resume : figure out  filter on API request\n       *@example : condition:idutilisateur:egal:1:OR:idutilisateur:egal:4:separator:AND:condition:idprojet:egal:1:OR:idprojet:egal:4060:separator:AND:condition:idsociete:egal:4:OR:idsociete:egal:2234\n       **/\n\n      let filter = \"\";\n      // filtering users\n      if (this.selectedUsers.length > 0) {\n        filter = filter.concat(\n          filter.length === 0 ? \"condition:\" : \":separator:AND:condition:\",\n          this.setfilter(\n            this.selectedUsers.map((e) => {\n              return e.id;\n            }),\n            \"idutilisateur\"\n          )\n        );\n      }\n\n      // idprojet\n      if (this.idprojets.length > 0) {\n        filter = filter.concat(\n          filter.length === 0 ? \"condition:\" : \":separator:AND:condition:\",\n          this.setfilter(this.idprojets, \"idprojet\")\n        );\n      }\n\n      // idcontact\n      if (this.idcontacts.length > 0) {\n        filter = filter.concat(\n          filter.length === 0 ? \"condition:\" : \":separator:AND:condition:\",\n          this.setfilter(this.idcontacts, \"idcontact\")\n        );\n      }\n\n      // idsociete\n      if (this.idsocietes.length > 0) {\n        filter = filter.concat(\n          filter.length === 0 ? \"condition:\" : \":separator:AND:condition:\",\n          this.setfilter(this.idsocietes, \"idsociete\")\n        );\n      }\n\n      // Setting condition on Dates\n\n      filter = filter.concat(\n        filter.length === 0 ? \"condition:\" : \":separator:AND:condition:\",\n        dateFilter +\n          \":biggerthanoregal:\" +\n          this.startDate +\n          \":AND:\" +\n          dateFilter +\n          \":lowerthanoregal:\" +\n          this.endDate\n      );\n\n      return filter;\n    },\n    setfilter(listArray, param) {\n      if (listArray.length === 1) {\n        return param + \":egal:\" + listArray[0];\n      } else {\n        return (\n          param +\n          \":egal:\" +\n          listArray[0] +\n          \":OR:\" +\n          this.setfilter(listArray.slice(1), param)\n        );\n      }\n    },\n\n    async getCalendarItem(nbPage = 0, onDueDate = false) {\n      return axios({\n        method: \"get\",\n        url:\n          this.URI +\n          this.API_KEY +\n          \"/\" +\n          this.getQueryParam(onDueDate ? \"date_echeance\" : \"date_action\") +\n          \"/\" +\n          nbPage,\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      }).then((response) => {\n        if (response.data.data.length > 0) {\n          let result = response.data.data.map((element) => {\n            return {\n              start: element.date_action.value,\n              end: element.date_fin.value,\n              isReadOnly: element.e_lock.value === \"1\",\n              location: element.location.value,\n              idaction: element.idaction.value,\n              title: element.sujet.value,\n              bgColor:\n                onDueDate && this.typeview.index != \"color_priorite\"\n                  ? \"#f2a640\"\n                  : this.setColor(this.typeview, element),\n              category: \"time\",\n              dueDateClass: element.date_echeance.value,\n              id: element.idaction.value.toString(),\n              calendarId:\n                this.getCalendarIdWithColor(element.color.value) || \"0\",\n            };\n          });\n          return Promise.all([\n            ...result,\n            this.getCalendarItem(++nbPage, onDueDate),\n          ]);\n        } else {\n          return [];\n        }\n      });\n    },\n    async getIteractionsHistory(nbPage = 0) {\n      return axios({\n        method: \"get\",\n        url:\n          this.URI_HISTORY +\n          this.API_KEY +\n          \"/\" +\n          this.getQueryParam() +\n          \"/\" +\n          nbPage,\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n      }).then((response) => {\n        if (response.data.data.length > 0) {\n          //let index = 0;\n          let result = response.data.data.map((element) => {\n            return {\n              start: element.date_action.value,\n              end: element.date_fin.value,\n              isReadOnly: element.e_lock.value === \"1\",\n              location: element.location.value,\n              idaction: element.idaction.value,\n              //   state: element.etat.value === 0 ? \"Busy\" : \"Free\",\n              title: element.sujet.value,\n              bgColor: \"#8cbf40\", // this.setColor(this.typeview, element),\n              category: \"time\",\n              // color: this.setColor(this.typeview, element),\n              dueDateClass: element.date_echeance.value,\n              id: element.idaction.value.toString(),\n              calendarId:\n                this.getCalendarIdWithColor(element.color.value) || \"0\",\n            };\n          });\n          return Promise.all([...result, this.getIteractionsHistory(++nbPage)]);\n        } else {\n          return [];\n        }\n      });\n    },\n    currentCalendarDate(format) {\n      var currentDate = moment([\n        this.$refs.tuiCalendar.invoke(\"getDate\").getFullYear(),\n        this.$refs.tuiCalendar.invoke(\"getDate\").getMonth(),\n        this.$refs.tuiCalendar.invoke(\"getDate\").getDate(),\n      ]);\n\n      // first letter uppercase\n      return (\n        currentDate.locale(this.locale).format(format).charAt(0).toUpperCase() +\n        currentDate.locale(this.locale).format(format).slice(1)\n      );\n    },\n    getCalendarWithColor(color) {\n      // get index\n      let index = this.calendarList.findIndex(\n        (element) => element.bgColor === color\n      );\n      // return calendar\n      return this.calendarList[index]?.bgColor || \"#FFF\";\n    },\n    getCalendarIdWithColor(color) {\n      // get index\n      let index = this.calendarList.findIndex(\n        (element) => element.bgColor === color\n      );\n      // return calendar\n      return this.calendarList[index]?.id;\n    },\n    getToday() {\n      this.$refs.tuiCalendar.invoke(\"today\");\n      this.setRenderRangeText();\n      this.dispatchAction();\n    },\n    next() {\n      this.$refs.tuiCalendar.invoke(\"next\");\n      this.setRenderRangeText();\n      this.dispatchAction();\n    },\n    prev() {\n      this.$refs.tuiCalendar.invoke(\"prev\");\n      this.setRenderRangeText();\n      this.dispatchAction();\n    },\n    today() {\n      this.$refs.tuiCalendar.invoke(\"today\");\n      this.setRenderRangeText();\n      this.dispatchAction();\n    },\n    changeView(viewName) {\n      this.$refs.tuiCalendar.invoke(\"changeView\", viewName);\n    },\n    onClickSchedule(res) {\n      this.selected = res;\n\n      // set more card to display none\n      let card = document.getElementsByClassName(\n        \"tui-full-calendar-month-more\"\n      );\n      card[0].style.display = \"none\";\n    },\n    onClickDayname(res) {\n      // view : week, day\n      console.group(\"onClickDayname\");\n      console.log(res.date);\n      console.groupEnd();\n    },\n\n    onBeforeCreateSchedule(e) {\n      this.event = e;\n      const eventDate = e.start.toDate();\n      this.dateCreateEvent =\n        eventDate.toLocaleDateString(\"fr-CA\") +\n        \"_\" +\n        (eventDate.getHours() < 10 ? \"0\" : \"\") +\n        eventDate.getHours() +\n        \"-\" +\n        (eventDate.getMinutes() < 10 ? \"0\" : \"\") +\n        eventDate.getMinutes();\n      e.guide.clearGuideElement();\n      this.clickCount = this.clickCount === 0 ? 1 : 0;\n      this.creating = this.clickCount === 0;\n      setTimeout(() => {\n        this.openIframeEditor();\n      }, 50);\n    },\n    onBeforeUpdateSchedule(e) {\n      var em = this;\n\n      let schedule = this.CscheduleList.find(\n        (element) => element.id === e.schedule.id\n      );\n\n      e.schedule.start = e.start;\n      e.schedule.end = e.end;\n      schedule.calendarId = e.changes.calendarId || e.schedule.calendarId;\n      schedule.title = e.changes.title || e.schedule.title;\n      schedule.category = e.changes.isAllDay\n        ? \"allday\"\n        : \"time\" || e.changes.category;\n\n      schedule.start = e.start;\n      schedule.end = e.end;\n      schedule.isReadOnly = e.changes.isPrivate || e.changes.isReadOnly;\n      schedule.location = e.changes.location || e.schedule.location;\n      schedule.bgColor =\n        this.calendarList[\n          e.changes.calendarId || e.schedule.calendarId\n        ].bgColor;\n\n      var t = new Date(e.schedule.start).toISOString();\n      t = String(t).replace(\"T\", \" \");\n      t = String(t).replace(\".000Z\", \"\");\n\n      const time_difference = e.end.getTime() - e.start.getTime();\n      //calculate days difference by dividing total milliseconds in a day\n      const hours = Math.floor(time_difference / (1000 * 60 * 60));\n      const remaining_milliseconds = time_difference % (1000 * 60 * 60);\n      const minutes = Math.floor(remaining_milliseconds / (1000 * 60));\n\n      var config = {\n        method: \"put\",\n        url: this.URI_ACTION + this.API_KEY,\n\n        headers: {\n          \"Content-Type\": \"application/json\",\n        },\n        data: JSON.stringify({\n          idaction: schedule.idaction,\n          sujet: schedule.title,\n          all_day: schedule.category == \"allday\" ? 1 : 0,\n          date_action: t,\n          duree_heures: hours,\n          duree_minutes: minutes,\n          location: schedule.location,\n          //    etat: schedule.state == \"Busy\" ? 1 : 0,\n          color: schedule.bgColor,\n          e_lock: schedule.isReadOnly ? 1 : 0,\n        }),\n      };\n\n      axios(config).then(function () {\n        em.CscheduleList = em.CscheduleList.map((element) =>\n          element.id !== e.schedule.id\n            ? element\n            : {\n                ...element,\n                ...schedule,\n              }\n        );\n\n        em.$refs.tuiCalendar.invoke(\"updateSchedule\", e.schedule.id, schedule);\n      });\n    },\n\n    onBeforeDeleteSchedule(e) {\n      this.selected = null;\n\n      var idaction = this.CscheduleList.find((element) => {\n        return element.id === e.schedule.id;\n      })?.idaction;\n\n      var config = {\n        method: \"delete\",\n        url: this.URI_ACTION + this.API_KEY + \"/\" + idaction,\n        headers: {},\n      };\n\n      axios(config).then(() => {\n        // remove in scheduleList\n        this.CscheduleList = this.CscheduleList.filter(\n          (element) => element.id !== e.schedule.id\n        );\n        this.$refs.tuiCalendar.invoke(\n          \"deleteSchedule\",\n          e.schedule.id,\n          e.schedule.calendarId\n        );\n      });\n    },\n    //Suppression des taches\n    onClickTimezonesCollapseBtn(timezonesCollapsed) {\n      // view : week, day\n      if (timezonesCollapsed) {\n        this.theme[\"week.timegridLeft.width\"] = \"100px\";\n        this.theme[\"week.daygridLeft.width\"] = \"100px\";\n      } else {\n        this.theme[\"week.timegridLeft.width\"] = \"50px\";\n        this.theme[\"week.daygridLeft.width\"] = \"50px\";\n      }\n    },\n    getCalendar(calendarId) {\n      return this.calendarList.find((calendar) => calendar.id === calendarId);\n    },\n    openIframeEditor() {\n      // create div card by getelementbyid\n      let card = document.getElementById(\"floating-layer-container\");\n\n      // set 2/3 width of screen to card only on desktop\n      if (card != null) {\n        if (window.innerWidth > 768) {\n          card.style.width = \"calc(100% - 250px)\";\n          card.style.height = \"calc(100% - 250px)\";\n          card.style.left = \"calc(50% - (calc(100% - 250px) / 2))\";\n          card.style.top = \"calc(50% - (calc(100% - 250px) / 2))\";\n        } else {\n          card.style.width = \"calc(100% - 150px)\";\n          card.style.left = \"calc(50% - (calc(100% - 150px) / 2))\";\n          card.style.top = \"calc(50% - (calc(100% - 800px) / 2))\";\n          card.style.height = \"calc(100% - 150px)\";\n        }\n\n      }\n    },\n    checkingFrame(e) {\n      console.log(\"message\");\n      console.log(e);\n            console.log(this.$refs.editdata);\n    },\n    edit() {\n      this.editing = true;\n      this.openIframeEditor();\n    },\n    iframeLoaded() {\n      // get iframe document\n      let iframe = document.getElementById(\"tui-full-calendar-popup-iframe\");\n\n      // check url\n      if (\n        iframe &&\n        iframe.contentWindow.location.href.includes(\"/action.php\")\n      ) {\n        this.editing = false;\n        this.creating = false;\n        this.selected = null;\n      }\n    },\n  },\n  watch: {\n    view(value) {\n      this.changeView(value);\n      this.setRenderRangeText();\n    },\n    selected(content) {\n      setTimeout(() => {\n        this.editing = false;\n        let event = null;\n        if (content && content.event) {\n          event = content.event;\n          // get position from event\n          const position = {\n            top: event.pageY - event.target.offsetTop,\n            left: event.pageX - event.target.offsetLeft,\n          };\n\n          // get div card by getelementbyid\n          let card = document.getElementById(\"floating-layer-container\");\n\n          // set position from event mouse to card\n          if (card) {\n            card.style.top = `calc(${position.top}px - 80px)`;\n            card.style.left = `calc(${position.left}px + 25px)`;\n          }\n        }\n      }, 100);\n    },\n  },\n  async mounted() {\n    this.getTemplate();\n    await this.loadUsers(); // loading users list*\n    this.setRenderRangeText();\n    this.dispatchAction(); // Load and set calendat item;\n\n    // click outslide to close card\n    document.addEventListener(\"click\", (e) => {\n      // if click outslide\n      if (\n        (document.getElementById(\"calendar\").contains(e.target) === false &&\n          !this.editing) ||\n        (e.target.className !== \"tui-full-calendar-weekday-schedule\" &&\n          e.target.className !== \"tui-full-calendar-weekday-schedule-title\" &&\n          e.target.className.includes(\"tui-full-calendar-weekday-grid-line\") &&\n          e.target.className ===\n            \"tui-full-calendar-weekday-schedule-content\") ||\n        e.target.className.includes(\n          \"tui-full-calendar-time-date-schedule-block-wrap\"\n        ) ||\n        ((e.target.className.includes(\"tui-full-calendar-weekday-schedule\") ||\n          e.target.className.includes(\n            \"tui-full-calendar-weekday-schedule-content\"\n          ) ||\n          e.target.className.includes(\"tui-full-calendar-weekday-grid-line\") ||\n          e.target.className.includes(\n            \"tui-full-calendar-time-date-schedule-block-wrap\"\n          )) &&\n          this.editing) ||\n        ((e.target.className.includes(\"tui-full-calendar-weekday-grid-line\") ||\n          e.target.className.includes(\n            \"tui-full-calendar-time-date-schedule-block-wrap\"\n          )) &&\n          this.editing &&\n          this.creating)\n      ) {\n        this.editing = false;\n        this.creating = false;\n        this.selected = null;\n        if (this.clickCount === 1) this.clickCount === 2;\n        if (this.clickCount === 2) this.clickCount === 0;\n      } else if (\n        this.selected !== null &&\n        e.target.className !== \"tui-full-calendar-weekday-schedule-title\" &&\n        e.target.className !==\n          \"tui-full-calendar-time-schedule-content tui-full-calendar-time-schedule-content-time\" &&\n        !this.editing\n      ) {\n        this.selected = null;\n        if (this.clickCount === 1) this.clickCount === 2;\n        if (this.clickCount === 2) this.clickCount === 0;\n      } else if (\n        e.target.className === \"tui-full-calendar-weekday-schedule-title\" ||\n        e.target.className ===\n          \"tui-full-calendar-time-schedule-content tui-full-calendar-time-schedule-content-time\"\n      ) {\n        this.creating = false;\n        if (this.clickCount === 1) this.clickCount === 2;\n        if (this.clickCount === 2) this.clickCount === 0;\n      }\n    });\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import \"@/variables.scss\";\n</style>\n"]}]}